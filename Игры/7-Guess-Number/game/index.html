<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ - –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ—Ç–µ–∫—Ç–∏–≤!</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(
          135deg,
          #667eea 0%,
          #764ba2 50%,
          #f093fb 100%
        );
        margin: 0;
        padding: 10px;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #333;
      }

      .back-to-games {
        position: fixed;
        top: 20px;
        left: 20px;
        background: #4caf50;
        color: white;
        padding: 12px 20px;
        border-radius: 25px;
        text-decoration: none;
        font-weight: 600;
        font-size: 0.95rem;
        box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        transition: all 0.3s ease;
        z-index: 1000;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .back-to-games:hover {
        background: #45a049;
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
      }

      .game-container {
        text-align: center;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 25px;
        padding: 20px;
        border: 3px solid rgba(102, 126, 234, 0.8);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        max-width: 700px;
        backdrop-filter: blur(10px);
      }

      h1 {
        font-size: 2rem;
        margin-bottom: 5px;
        color: #5a67d8;
        text-shadow: 0 2px 4px rgba(90, 103, 216, 0.3);
      }

      .subtitle {
        font-size: 1rem;
        margin-bottom: 15px;
        color: #555;
      }

      .game-stats {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
        margin-bottom: 15px;
      }

      .stat-card {
        background: linear-gradient(135deg, #ff9a9e, #fecfef);
        padding: 12px;
        border-radius: 15px;
        color: #d63384;
        font-weight: bold;
        border: 2px solid #ff6b9d;
      }

      .stat-number {
        font-size: 1.5rem;
        display: block;
      }

      .stat-label {
        font-size: 0.8rem;
        opacity: 0.9;
      }

      .difficulty-selector {
        margin-bottom: 20px;
      }

      .difficulty-btn {
        background: linear-gradient(135deg, #74b9ff, #0984e3);
        color: white;
        border: none;
        padding: 10px 20px;
        font-size: 0.9rem;
        border-radius: 20px;
        cursor: pointer;
        margin: 5px;
        transition: all 0.3s ease;
        font-weight: bold;
      }

      .difficulty-btn:hover {
        transform: scale(1.05);
      }

      .difficulty-btn.active {
        background: linear-gradient(135deg, #00b894, #00a085);
        box-shadow: 0 5px 15px rgba(0, 184, 148, 0.4);
      }

      .game-area {
        background: linear-gradient(135deg, #ffeaa7, #fab1a0);
        border-radius: 25px;
        padding: 25px;
        margin: 20px 0;
        border: 3px solid #e17055;
        position: relative;
      }

      .mystery-number {
        font-size: 4rem;
        margin: 15px 0;
        color: #2d3436;
        text-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
      }

      .range-display {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        padding: 15px;
        margin: 15px 0;
        border: 2px solid #ddd;
      }

      .range-text {
        font-size: 1.2rem;
        color: #2c3e50;
        font-weight: bold;
      }

      .attempts-info {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin: 15px 0;
      }

      .attempts-card {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        padding: 15px;
        border: 2px solid #3498db;
      }

      .attempts-number {
        font-size: 2rem;
        color: #e74c3c;
        font-weight: bold;
        display: block;
      }

      .attempts-label {
        font-size: 0.9rem;
        color: #7f8c8d;
      }

      .input-section {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 20px;
        margin: 20px 0;
        border: 3px solid #9b59b6;
      }

      .guess-input {
        font-size: 2rem;
        padding: 15px 20px;
        border: 3px solid #74b9ff;
        border-radius: 15px;
        text-align: center;
        width: 200px;
        margin: 10px;
      }

      .guess-input:focus {
        outline: none;
        border-color: #0984e3;
        box-shadow: 0 0 20px rgba(116, 185, 255, 0.5);
      }

      .guess-btn {
        background: linear-gradient(135deg, #2ecc71, #27ae60);
        color: white;
        border: none;
        padding: 15px 30px;
        font-size: 1.2rem;
        border-radius: 15px;
        cursor: pointer;
        margin: 10px;
        transition: all 0.3s ease;
        font-weight: bold;
      }

      .guess-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 20px rgba(46, 204, 113, 0.4);
      }

      .guess-btn:disabled {
        background: linear-gradient(135deg, #bdc3c7, #95a5a6);
        cursor: not-allowed;
        transform: none;
      }

      .feedback-area {
        background: linear-gradient(135deg, #667eea, #764ba2);
        border-radius: 20px;
        padding: 20px;
        margin: 20px 0;
        color: white;
        min-height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
      }

      .feedback-text {
        font-size: 1.4rem;
        font-weight: bold;
        margin-bottom: 10px;
      }

      .hint-text {
        font-size: 1rem;
        opacity: 0.9;
      }

      .guess-history {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        padding: 15px;
        margin: 15px 0;
        border: 2px solid #f39c12;
        max-height: 150px;
        overflow-y: auto;
      }

      .guess-item {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 8px 12px;
        margin: 5px 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-left: 4px solid #3498db;
      }

      .guess-item.too-high {
        border-left-color: #e74c3c;
      }

      .guess-item.too-low {
        border-left-color: #f39c12;
      }

      .guess-item.correct {
        border-left-color: #27ae60;
        background: #d5f4e6;
      }

      .action-buttons {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        margin: 20px 0;
      }

      .action-btn {
        background: linear-gradient(135deg, #a8e6cf, #88d8a3);
        color: #2d3436;
        border: none;
        padding: 12px 15px;
        font-size: 0.9rem;
        border-radius: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: bold;
      }

      .action-btn:hover {
        transform: scale(1.05);
      }

      .hint-btn {
        background: linear-gradient(135deg, #fdcb6e, #e17055);
      }
      .newgame-btn {
        background: linear-gradient(135deg, #74b9ff, #0984e3);
        color: white;
      }
      .stats-btn {
        background: linear-gradient(135deg, #fd79a8, #fdcb6e);
      }

      .achievements-section {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 20px;
        padding: 15px;
        margin: 15px 0;
        border: 3px solid #e67e22;
      }

      .achievement {
        background: #e67e22;
        color: white;
        padding: 8px 15px;
        border-radius: 20px;
        margin: 5px;
        display: inline-block;
        font-size: 0.85rem;
        font-weight: bold;
      }

      .special-modes {
        margin: 20px 0;
      }

      .special-btn {
        background: linear-gradient(135deg, #a29bfe, #6c5ce7);
        color: white;
        border: none;
        padding: 12px 20px;
        font-size: 0.9rem;
        border-radius: 15px;
        cursor: pointer;
        margin: 5px;
        transition: all 0.3s ease;
        font-weight: bold;
      }

      .special-btn:hover {
        transform: scale(1.05);
      }

      .progress-bar {
        background: #ecf0f1;
        border-radius: 15px;
        height: 20px;
        margin: 10px 0;
        overflow: hidden;
        border: 2px solid #bdc3c7;
      }

      .progress-fill {
        background: linear-gradient(135deg, #2ecc71, #27ae60);
        height: 100%;
        border-radius: 13px;
        transition: width 0.5s ease;
      }

      .celebration {
        position: fixed;
        font-size: 3rem;
        animation: celebrate 2s ease-out forwards;
        pointer-events: none;
        z-index: 1000;
      }

      @keyframes celebrate {
        0% {
          opacity: 1;
          transform: translateY(0) scale(1) rotate(0deg);
        }
        100% {
          opacity: 0;
          transform: translateY(-200px) scale(2) rotate(360deg);
        }
      }

      .temperature-gauge {
        background: linear-gradient(135deg, #74b9ff, #0984e3);
        border-radius: 15px;
        padding: 15px;
        margin: 15px 0;
        color: white;
        display: none;
      }

      .temperature-text {
        font-size: 1.2rem;
        font-weight: bold;
      }

      .smart-hints {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        padding: 15px;
        margin: 15px 0;
        border: 2px solid #8e44ad;
      }

      .hint-indicator {
        font-size: 0.9rem;
        color: #7f8c8d;
        margin: 5px 0;
      }

      .binary-search-mode {
        background: linear-gradient(135deg, #2d3436, #636e72);
        color: white;
        border-radius: 15px;
        padding: 15px;
        margin: 15px 0;
        display: none;
      }

      .optimal-path {
        color: #00b894;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <a href="../../index.html" class="back-to-games">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∏–≥—Ä–∞–º</a>
    <div class="game-container">
      <h1>üïµÔ∏è‚Äç‚ôÇÔ∏è –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ—Ç–µ–∫—Ç–∏–≤! üïµÔ∏è‚Äç‚ôÇÔ∏è</h1>
      <p class="subtitle">
        –ù–∞–π–¥–∏ –∑–∞–≥–∞–¥–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ —Å –ø–æ–º–æ—â—å—é –ª–æ–≥–∏–∫–∏ –∏ –¥–µ–¥—É–∫—Ü–∏–∏!
      </p>

      <div class="game-stats">
        <div class="stat-card">
          <span class="stat-number" id="gamesPlayed">0</span>
          <span class="stat-label">–ò–≥—Ä</span>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="gamesWon">0</span>
          <span class="stat-label">–ü–æ–±–µ–¥</span>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="bestScore">0</span>
          <span class="stat-label">–õ—É—á—à–∏–π</span>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="avgAttempts">0</span>
          <span class="stat-label">–°—Ä–µ–¥–Ω–µ–µ</span>
        </div>
      </div>

      <div class="difficulty-selector">
        <p><strong>üéØ –í—ã–±–µ—Ä–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å:</strong></p>
        <button
          class="difficulty-btn active"
          onclick="setDifficulty('easy')"
          id="easy"
        >
          üòä –õ—ë–≥–∫–∏–π (1-50)
        </button>
        <button
          class="difficulty-btn"
          onclick="setDifficulty('medium')"
          id="medium"
        >
          üòé –°—Ä–µ–¥–Ω–∏–π (1-100)
        </button>
        <button
          class="difficulty-btn"
          onclick="setDifficulty('hard')"
          id="hard"
        >
          ü§Ø –°–ª–æ–∂–Ω—ã–π (1-500)
        </button>
        <button
          class="difficulty-btn"
          onclick="setDifficulty('extreme')"
          id="extreme"
        >
          üî• –≠–∫—Å—Ç—Ä–∏–º (1-1000)
        </button>
      </div>

      <div class="game-area">
        <div class="mystery-number">‚ùì‚ùì‚ùì</div>

        <div class="range-display">
          <div class="range-text" id="rangeText">
            –Ø –∑–∞–≥–∞–¥–∞–ª —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 50
          </div>
          <div class="progress-bar">
            <div
              class="progress-fill"
              id="progressFill"
              style="width: 0%"
            ></div>
          </div>
        </div>

        <div class="attempts-info">
          <div class="attempts-card">
            <span class="attempts-number" id="currentAttempts">0</span>
            <span class="attempts-label">–ü–æ–ø—ã—Ç–∫–∏</span>
          </div>
          <div class="attempts-card">
            <span class="attempts-number" id="maxAttempts">7</span>
            <span class="attempts-label">–õ–∏–º–∏—Ç</span>
          </div>
        </div>
      </div>

      <div class="input-section">
        <h3 style="margin-top: 0; color: #8e44ad">üéØ –¢–≤–æ—è –¥–æ–≥–∞–¥–∫–∞:</h3>
        <input
          type="number"
          class="guess-input"
          id="guessInput"
          placeholder="?"
          onkeypress="handleKeyPress(event)"
        />
        <br />
        <button class="guess-btn" onclick="makeGuess()" id="guessButton">
          üéØ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å!
        </button>
      </div>

      <div class="temperature-gauge" id="temperatureGauge">
        <div class="temperature-text" id="temperatureText">
          üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: –•–æ–ª–æ–¥–Ω–æ
        </div>
      </div>

      <div class="feedback-area">
        <div class="feedback-text" id="feedbackText">
          –°–¥–µ–ª–∞–π —Å–≤–æ—é –ø–µ—Ä–≤—É—é –ø–æ–ø—ã—Ç–∫—É!
        </div>
        <div class="hint-text" id="hintText">–ò—Å–ø–æ–ª—å–∑—É–π –ª–æ–≥–∏–∫—É –∏ –∞–Ω–∞–ª–∏–∑ üß†</div>
      </div>

      <div class="smart-hints">
        <h4 style="margin-top: 0; color: #8e44ad">üí° –£–º–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏:</h4>
        <div class="hint-indicator" id="rangeHint">
          –ü–æ–ª–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω
        </div>
        <div class="hint-indicator" id="strategyHint">
          –ü–æ–ø—Ä–æ–±—É–π –º–µ—Ç–æ–¥ –¥–µ–ª–µ–Ω–∏—è –ø–æ–ø–æ–ª–∞–º
        </div>
        <div class="hint-indicator" id="proximityHint">
          –ü–æ–¥—Å–∫–∞–∑–∫–∏ –æ –±–ª–∏–∑–æ—Å—Ç–∏ –ø–æ—è–≤—è—Ç—Å—è –ø–æ—Å–ª–µ –ø–æ–ø—ã—Ç–∫–∏
        </div>
      </div>

      <div class="binary-search-mode" id="binarySearchMode">
        <h4 style="margin-top: 0">ü§ñ –†–µ–∂–∏–º –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞:</h4>
        <p>
          –°–ª–µ–¥—É—é—â–∏–π –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ö–æ–¥:
          <span class="optimal-path" id="optimalGuess">25</span>
        </p>
        <p>
          –ú–∞–∫—Å–∏–º—É–º —à–∞–≥–æ–≤ –¥–æ –ø–æ–±–µ–¥—ã:
          <span class="optimal-path" id="maxSteps">6</span>
        </p>
      </div>

      <div class="guess-history">
        <h4 style="margin-top: 0; color: #f39c12">üìù –ò—Å—Ç–æ—Ä–∏—è –ø–æ–ø—ã—Ç–æ–∫:</h4>
        <div id="historyList">–ü–æ–ø—ã—Ç–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...</div>
      </div>

      <div class="action-buttons">
        <button class="action-btn hint-btn" onclick="getHint()">
          üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞
        </button>
        <button class="action-btn newgame-btn" onclick="newGame()">
          üé≤ –ù–æ–≤–∞—è –∏–≥—Ä–∞
        </button>
        <button class="action-btn stats-btn" onclick="toggleMode()">
          üìä –†–µ–∂–∏–º
        </button>
      </div>

      <div class="special-modes">
        <button class="special-btn" onclick="toggleTemperature()">
          üå°Ô∏è –¢–µ—Ä–º–æ–º–µ—Ç—Ä
        </button>
        <button class="special-btn" onclick="toggleBinarySearch()">
          ü§ñ –ò–ò –ø–æ–º–æ—â—å
        </button>
        <button class="special-btn" onclick="showStrategies()">
          üìö –°—Ç—Ä–∞—Ç–µ–≥–∏–∏
        </button>
        <button class="special-btn" onclick="resetStats()">üîÑ –°–±—Ä–æ—Å</button>
      </div>

      <div class="achievements-section">
        <h4 style="margin-top: 0; color: #d35400">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è:</h4>
        <div id="achievementsList">–ò–≥—Ä–∞–π, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è!</div>
      </div>
    </div>

    <script>
      // –ò–≥—Ä–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
      let gameState = {
        secretNumber: 0,
        minRange: 1,
        maxRange: 50,
        attempts: 0,
        maxAttempts: 7,
        guessHistory: [],
        difficulty: "easy",
        gameActive: true,
        hintsUsed: 0,
        showTemperature: false,
        showBinarySearch: false,
      };

      // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
      let stats = {
        gamesPlayed: 0,
        gamesWon: 0,
        totalAttempts: 0,
        bestScore: 0,
        achievements: [],
      };

      // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
      const difficultySettings = {
        easy: { min: 1, max: 50, attempts: 7 },
        medium: { min: 1, max: 100, attempts: 8 },
        hard: { min: 1, max: 500, attempts: 10 },
        extreme: { min: 1, max: 1000, attempts: 12 },
      };

      // –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
      const achievements = [
        {
          id: "first_win",
          name: "üåü –ü–µ—Ä–≤–∞—è –ø–æ–±–µ–¥–∞",
          condition: () => stats.gamesWon >= 1,
        },
        {
          id: "lucky_guess",
          name: "üçÄ –í–µ–∑—É—á–∏–π",
          condition: () => gameState.attempts === 1 && !gameState.gameActive,
        },
        {
          id: "efficient",
          name: "üéØ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π",
          condition: () => stats.bestScore <= 3,
        },
        {
          id: "persistent",
          name: "üí™ –£–ø–æ—Ä–Ω—ã–π",
          condition: () => stats.gamesPlayed >= 10,
        },
        {
          id: "master",
          name: "üëë –ú–∞—Å—Ç–µ—Ä –¥–µ–¥—É–∫—Ü–∏–∏",
          condition: () => stats.gamesWon >= 20,
        },
        {
          id: "perfectionist",
          name: "üí´ –ü–µ—Ä—Ñ–µ–∫—Ü–∏–æ–Ω–∏—Å—Ç",
          condition: () =>
            stats.gamesWon >= 5 && stats.gamesWon === stats.gamesPlayed,
        },
      ];

      // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
      function setDifficulty(level) {
        gameState.difficulty = level;
        const settings = difficultySettings[level];

        gameState.minRange = settings.min;
        gameState.maxRange = settings.max;
        gameState.maxAttempts = settings.attempts;

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏
        document
          .querySelectorAll(".difficulty-btn")
          .forEach((btn) => btn.classList.remove("active"));
        document.getElementById(level).classList.add("active");

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –Ω–æ–≤–∞—è –∏–≥—Ä–∞
        updateRangeDisplay();
        document.getElementById("maxAttempts").textContent =
          gameState.maxAttempts;
        newGame();
      }

      // –ù–æ–≤–∞—è –∏–≥—Ä–∞
      function newGame() {
        gameState.secretNumber =
          Math.floor(
            Math.random() * (gameState.maxRange - gameState.minRange + 1)
          ) + gameState.minRange;
        gameState.attempts = 0;
        gameState.guessHistory = [];
        gameState.gameActive = true;
        gameState.hintsUsed = 0;

        // –°–±—Ä–æ—Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        document.getElementById("currentAttempts").textContent = "0";
        document.getElementById("guessInput").value = "";
        document.getElementById("guessInput").disabled = false;
        document.getElementById("guessButton").disabled = false;
        document.getElementById("historyList").innerHTML =
          "–ü–æ–ø—ã—Ç–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...";
        document.getElementById("feedbackText").textContent =
          "–°–¥–µ–ª–∞–π —Å–≤–æ—é –ø–µ—Ä–≤—É—é –ø–æ–ø—ã—Ç–∫—É!";
        document.getElementById("hintText").textContent =
          "–ò—Å–ø–æ–ª—å–∑—É–π –ª–æ–≥–∏–∫—É –∏ –∞–Ω–∞–ª–∏–∑ üß†";
        document.querySelector(".mystery-number").textContent = "‚ùì‚ùì‚ùì";
        document.getElementById("progressFill").style.width = "0%";

        updateRangeDisplay();
        updateSmartHints();
        updateBinarySearch();

        console.log("–ó–∞–≥–∞–¥–∞–Ω–æ —á–∏—Å–ª–æ:", gameState.secretNumber); // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
      }

      // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —É–≥–∞–¥—ã–≤–∞–Ω–∏—è
      function makeGuess() {
        const guessInput = document.getElementById("guessInput");
        const guess = parseInt(guessInput.value);

        // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞
        if (isNaN(guess)) {
          showFeedback("‚ùå –í–≤–µ–¥–∏ —á–∏—Å–ª–æ!", "–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑");
          return;
        }

        if (guess < gameState.minRange || guess > gameState.maxRange) {
          showFeedback(
            "‚ùå –ß–∏—Å–ª–æ –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞!",
            `–í–≤–µ–¥–∏ —á–∏—Å–ª–æ –æ—Ç ${gameState.minRange} –¥–æ ${gameState.maxRange}`
          );
          return;
        }

        if (!gameState.gameActive) {
          showFeedback("üé≤ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!", "–ù–∞—á–Ω–∏ –Ω–æ–≤—É—é –∏–≥—Ä—É");
          return;
        }

        gameState.attempts++;
        document.getElementById("currentAttempts").textContent =
          gameState.attempts;

        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        let result, feedback, hint;
        const difference = Math.abs(guess - gameState.secretNumber);

        if (guess === gameState.secretNumber) {
          result = "correct";
          feedback = "üéâ –ü–û–ó–î–†–ê–í–õ–Ø–Æ! –¢—ã —É–≥–∞–¥–∞–ª!";
          hint = `–ß–∏—Å–ª–æ –±—ã–ª–æ ${gameState.secretNumber}! –ó–∞ ${gameState.attempts} –ø–æ–ø—ã—Ç–æ–∫!`;
          winGame();
        } else if (guess < gameState.secretNumber) {
          result = "too-low";
          feedback = "üìà –ú–æ—ë —á–∏—Å–ª–æ –ë–û–õ–¨–®–ï!";
          hint = getSmartHint(guess, "higher", difference);
        } else {
          result = "too-high";
          feedback = "üìâ –ú–æ—ë —á–∏—Å–ª–æ –ú–ï–ù–¨–®–ï!";
          hint = getSmartHint(guess, "lower", difference);
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
        addToHistory(guess, result);

        // –ü–æ–∫–∞–∑ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
        showFeedback(feedback, hint);

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ—Ä–º–æ–º–µ—Ç—Ä–∞
        if (gameState.showTemperature && result !== "correct") {
          updateTemperature(difference);
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –ø–æ–ø—ã—Ç–æ–∫
        if (
          gameState.attempts >= gameState.maxAttempts &&
          result !== "correct"
        ) {
          loseGame();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        updateProgress();
        updateSmartHints();
        updateBinarySearch();

        guessInput.value = "";
      }

      // –£–º–Ω–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞
      function getSmartHint(guess, direction, difference) {
        if (difference <= 5) {
          return "üî• –û—á–µ–Ω—å –±–ª–∏–∑–∫–æ! –¢—ã –ø–æ—á—Ç–∏ —É —Ü–µ–ª–∏!";
        } else if (difference <= 15) {
          return "üå°Ô∏è –¢–µ–ø–ª–æ! –¢—ã –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø—É—Ç–∏!";
        } else if (difference <= 30) {
          return "‚ùÑÔ∏è –ü—Ä–æ—Ö–ª–∞–¥–Ω–æ! –ù—É–∂–Ω–æ –µ—â—ë –ø–æ–¥—É–º–∞—Ç—å";
        } else {
          return "üßä –•–æ–ª–æ–¥–Ω–æ! –ü–æ–ø—Ä–æ–±—É–π –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ –¥—Ä—É–≥–æ–µ —á–∏—Å–ª–æ";
        }
      }

      // –ü–æ–±–µ–¥–∞
      function winGame() {
        gameState.gameActive = false;
        document.getElementById("guessInput").disabled = true;
        document.getElementById("guessButton").disabled = true;
        document.querySelector(".mystery-number").textContent =
          gameState.secretNumber;

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        stats.gamesPlayed++;
        stats.gamesWon++;
        stats.totalAttempts += gameState.attempts;

        if (stats.bestScore === 0 || gameState.attempts < stats.bestScore) {
          stats.bestScore = gameState.attempts;
        }

        updateStats();
        checkAchievements();
        createCelebration();
      }

      // –ü–æ—Ä–∞–∂–µ–Ω–∏–µ
      function loseGame() {
        gameState.gameActive = false;
        document.getElementById("guessInput").disabled = true;
        document.getElementById("guessButton").disabled = true;

        showFeedback(
          "üòî –ü–æ–ø—ã—Ç–∫–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å!",
          `–ß–∏—Å–ª–æ –±—ã–ª–æ ${gameState.secretNumber}. –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑!`
        );
        document.querySelector(".mystery-number").textContent =
          gameState.secretNumber;

        stats.gamesPlayed++;
        stats.totalAttempts += gameState.attempts;
        updateStats();
      }

      // –ü–æ–∫–∞–∑ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
      function showFeedback(main, hint) {
        document.getElementById("feedbackText").textContent = main;
        document.getElementById("hintText").textContent = hint;
      }

      // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
      function addToHistory(guess, result) {
        gameState.guessHistory.push({ guess, result });

        const historyList = document.getElementById("historyList");
        const item = document.createElement("div");
        item.className = `guess-item ${result}`;

        let resultText = "";
        switch (result) {
          case "too-high":
            resultText = "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ";
            break;
          case "too-low":
            resultText = "–°–ª–∏—à–∫–æ–º –º–∞–ª–æ";
            break;
          case "correct":
            resultText = "üéØ –í–ï–†–ù–û!";
            break;
        }

        item.innerHTML = `
                <span>–ü–æ–ø—ã—Ç–∫–∞ ${gameState.attempts}: ${guess}</span>
                <span>${resultText}</span>
            `;

        if (historyList.textContent === "–ü–æ–ø—ã—Ç–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...") {
          historyList.innerHTML = "";
        }

        historyList.appendChild(item);
        historyList.scrollTop = historyList.scrollHeight;
      }

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
      function updateProgress() {
        const progress = (gameState.attempts / gameState.maxAttempts) * 100;
        document.getElementById("progressFill").style.width = progress + "%";

        // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        const fill = document.getElementById("progressFill");
        if (progress < 50) {
          fill.style.background = "linear-gradient(135deg, #2ecc71, #27ae60)";
        } else if (progress < 80) {
          fill.style.background = "linear-gradient(135deg, #f39c12, #e67e22)";
        } else {
          fill.style.background = "linear-gradient(135deg, #e74c3c, #c0392b)";
        }
      }

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞
      function updateRangeDisplay() {
        document.getElementById(
          "rangeText"
        ).textContent = `–Ø –∑–∞–≥–∞–¥–∞–ª —á–∏—Å–ª–æ –æ—Ç ${gameState.minRange} –¥–æ ${gameState.maxRange}`;
      }

      // –ü–æ–¥—Å–∫–∞–∑–∫–∞
      function getHint() {
        if (gameState.hintsUsed >= 3) {
          alert("‚ùå –ë–æ–ª—å—à–µ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –Ω–µ—Ç! –ò—Å–ø–æ–ª—å–∑—É–π –ª–æ–≥–∏–∫—É!");
          return;
        }

        if (!gameState.gameActive) {
          alert("üé≤ –ù–∞—á–Ω–∏ –Ω–æ–≤—É—é –∏–≥—Ä—É –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–æ–∫!");
          return;
        }

        gameState.hintsUsed++;

        const hints = [
          `üéØ –ß–∏—Å–ª–æ ${
            gameState.secretNumber % 2 === 0 ? "–ß–Å–¢–ù–û–ï" : "–ù–ï–ß–Å–¢–ù–û–ï"
          }`,
          `üî¢ –ß–∏—Å–ª–æ ${
            gameState.secretNumber <
            (gameState.minRange + gameState.maxRange) / 2
              ? "–≤ –ü–ï–†–í–û–ô –ø–æ–ª–æ–≤–∏–Ω–µ"
              : "–≤–æ –í–¢–û–†–û–ô –ø–æ–ª–æ–≤–∏–Ω–µ"
          } –¥–∏–∞–ø–∞–∑–æ–Ω–∞`,
          `üí´ –°—É–º–º–∞ —Ü–∏—Ñ—Ä —á–∏—Å–ª–∞: ${gameState.secretNumber
            .toString()
            .split("")
            .reduce((a, b) => a + parseInt(b), 0)}`,
        ];

        alert(
          `üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ ${gameState.hintsUsed}/3:\n${
            hints[gameState.hintsUsed - 1]
          }`
        );
      }

      // –¢–µ—Ä–º–æ–º–µ—Ç—Ä
      function toggleTemperature() {
        gameState.showTemperature = !gameState.showTemperature;
        const gauge = document.getElementById("temperatureGauge");
        gauge.style.display = gameState.showTemperature ? "block" : "none";
      }

      function updateTemperature(difference) {
        const range = gameState.maxRange - gameState.minRange;
        const percentage = difference / range;

        let temp, color;
        if (percentage < 0.05) {
          temp = "üî• –û—á–µ–Ω—å –≥–æ—Ä—è—á–æ!";
          color = "#e74c3c";
        } else if (percentage < 0.15) {
          temp = "üå°Ô∏è –ì–æ—Ä—è—á–æ!";
          color = "#e67e22";
        } else if (percentage < 0.3) {
          temp = "üòä –¢–µ–ø–ª–æ";
          color = "#f39c12";
        } else if (percentage < 0.5) {
          temp = "‚ùÑÔ∏è –ü—Ä–æ—Ö–ª–∞–¥–Ω–æ";
          color = "#3498db";
        } else {
          temp = "üßä –•–æ–ª–æ–¥–Ω–æ";
          color = "#74b9ff";
        }

        const gauge = document.getElementById("temperatureGauge");
        gauge.style.background = `linear-gradient(135deg, ${color}, ${color}dd)`;
        document.getElementById(
          "temperatureText"
        ).textContent = `üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: ${temp}`;
      }

      // –ë–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–∏—Å–∫
      function toggleBinarySearch() {
        gameState.showBinarySearch = !gameState.showBinarySearch;
        const mode = document.getElementById("binarySearchMode");
        mode.style.display = gameState.showBinarySearch ? "block" : "none";
        updateBinarySearch();
      }

      function updateBinarySearch() {
        if (!gameState.showBinarySearch) return;

        let min = gameState.minRange;
        let max = gameState.maxRange;

        // –£—á–∏—Ç—ã–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ø—ã—Ç–æ–∫
        gameState.guessHistory.forEach((item) => {
          if (item.result === "too-high") {
            max = Math.min(max, item.guess - 1);
          } else if (item.result === "too-low") {
            min = Math.max(min, item.guess + 1);
          }
        });

        const optimal = Math.floor((min + max) / 2);
        const maxSteps = Math.ceil(Math.log2(max - min + 1));

        document.getElementById("optimalGuess").textContent = optimal;
        document.getElementById("maxSteps").textContent = maxSteps;
      }

      // –£–º–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏
      function updateSmartHints() {
        let min = gameState.minRange;
        let max = gameState.maxRange;

        gameState.guessHistory.forEach((item) => {
          if (item.result === "too-high") {
            max = Math.min(max, item.guess - 1);
          } else if (item.result === "too-low") {
            min = Math.max(min, item.guess + 1);
          }
        });

        document.getElementById(
          "rangeHint"
        ).textContent = `–í–æ–∑–º–æ–∂–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: ${min} - ${max} (${
          max - min + 1
        } –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)`;

        if (gameState.attempts === 0) {
          document.getElementById("strategyHint").textContent =
            "–ü–æ–ø—Ä–æ–±—É–π –º–µ—Ç–æ–¥ –¥–µ–ª–µ–Ω–∏—è –ø–æ–ø–æ–ª–∞–º";
        } else {
          const optimal = Math.floor((min + max) / 2);
          document.getElementById(
            "strategyHint"
          ).textContent = `–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Å–ª–µ–¥—É—é—â–∏–π —Ö–æ–¥: ${optimal}`;
        }

        if (gameState.attempts > 0) {
          const lastGuess =
            gameState.guessHistory[gameState.guessHistory.length - 1];
          const difference = Math.abs(lastGuess.guess - gameState.secretNumber);
          document.getElementById(
            "proximityHint"
          ).textContent = `–ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞ –±—ã–ª–∞ –≤ ${difference} —á–∏—Å–ª–∞—Ö –æ—Ç —Ü–µ–ª–∏`;
        }
      }

      // –°—Ç—Ä–∞—Ç–µ–≥–∏–∏
      function showStrategies() {
        alert(`üéì –°–¢–†–ê–¢–ï–ì–ò–ò –ü–û–ò–°–ö–ê:

1. üéØ –î–µ–ª–µ–Ω–∏–µ –ø–æ–ø–æ–ª–∞–º
   –í—Å–µ–≥–¥–∞ –≤—ã–±–∏—Ä–∞–π —Å–µ—Ä–µ–¥–∏–Ω—É –¥–∏–∞–ø–∞–∑–æ–Ω–∞

2. üß† –õ–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑  
   –ò—Å–ø–æ–ª—å–∑—É–π –ø–æ–¥—Å–∫–∞–∑–∫–∏ –æ —á—ë—Ç–Ω–æ—Å—Ç–∏/–Ω–µ—á—ë—Ç–Ω–æ—Å—Ç–∏

3. üå°Ô∏è –¢–µ—Ä–º–æ–º–µ—Ç—Ä
   –û—Ä–∏–µ–Ω—Ç–∏—Ä—É–π—Å—è –Ω–∞ "—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É" 

4. üìä –ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
   –ò–∑—É—á–∞–π —Å–≤–æ–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø–æ–ø—ã—Ç–∫–∏

5. ü§ñ –ò–ò –ø–æ–º–æ—â—å
   –í–∫–ª—é—á–∏ —Ä–µ–∂–∏–º –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞`);
      }

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
      function updateStats() {
        document.getElementById("gamesPlayed").textContent = stats.gamesPlayed;
        document.getElementById("gamesWon").textContent = stats.gamesWon;
        document.getElementById("bestScore").textContent =
          stats.bestScore || "-";

        const avg =
          stats.gamesPlayed > 0
            ? (stats.totalAttempts / stats.gamesPlayed).toFixed(1)
            : 0;
        document.getElementById("avgAttempts").textContent = avg;
      }

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
      function checkAchievements() {
        achievements.forEach((achievement) => {
          if (
            !stats.achievements.includes(achievement.id) &&
            achievement.condition()
          ) {
            stats.achievements.push(achievement.id);
            alert(`üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: ${achievement.name}!`);
            updateAchievements();
          }
        });
      }

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
      function updateAchievements() {
        const list = document.getElementById("achievementsList");

        if (stats.achievements.length === 0) {
          list.innerHTML = "–ò–≥—Ä–∞–π, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è!";
          return;
        }

        list.innerHTML = achievements
          .filter((a) => stats.achievements.includes(a.id))
          .map((a) => `<span class="achievement">${a.name}</span>`)
          .join("");
      }

      // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∞–∑–¥–Ω–æ–≤–∞–Ω–∏—è
      function createCelebration() {
        const emojis = ["üéâ", "üéä", "üåü", "üí´", "üèÜ", "üëë"];

        for (let i = 0; i < 10; i++) {
          setTimeout(() => {
            const celebration = document.createElement("div");
            celebration.className = "celebration";
            celebration.textContent =
              emojis[Math.floor(Math.random() * emojis.length)];
            celebration.style.left = Math.random() * window.innerWidth + "px";
            celebration.style.top = window.innerHeight + "px";

            document.body.appendChild(celebration);
            setTimeout(() => celebration.remove(), 2000);
          }, i * 200);
        }
      }

      // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤
      function toggleMode() {
        const modes = ["classic", "temperature", "binary"];
        // –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤
        alert("üîÑ –†–µ–∂–∏–º—ã: –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π, —Å —Ç–µ—Ä–º–æ–º–µ—Ç—Ä–æ–º, —Å –ò–ò –ø–æ–º–æ—â—å—é!");
      }

      // –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
      function resetStats() {
        if (confirm("üîÑ –°–±—Ä–æ—Å–∏—Ç—å –≤—Å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É?")) {
          stats = {
            gamesPlayed: 0,
            gamesWon: 0,
            totalAttempts: 0,
            bestScore: 0,
            achievements: [],
          };
          updateStats();
          updateAchievements();
        }
      }

      // –û–±—Ä–∞–±–æ—Ç–∫–∞ Enter
      function handleKeyPress(event) {
        if (event.key === "Enter") {
          makeGuess();
        }
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
      document.addEventListener("DOMContentLoaded", function () {
        newGame();
        updateStats();
        updateAchievements();
      });
    </script>
  </body>
</html>
