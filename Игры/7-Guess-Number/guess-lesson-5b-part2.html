<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–£—Ä–æ–∫ 5b: –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å (–ß–∞—Å—Ç—å 2) | –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        margin: 0;
        padding: 0;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #333;
        overflow-x: hidden;
      }

      .header {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        padding: 1rem 0;
        position: relative;
        overflow: hidden;
      }

      .header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          45deg,
          rgba(255, 255, 255, 0.1) 25%,
          transparent 25%,
          transparent 75%,
          rgba(255, 255, 255, 0.1) 75%
        );
        background-size: 20px 20px;
        animation: headerPattern 20s linear infinite;
      }

      @keyframes headerPattern {
        0% {
          transform: translateX(0);
        }
        100% {
          transform: translateX(20px);
        }
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        position: relative;
        z-index: 1;
      }

      .header h1 {
        margin: 0;
        color: white;
        font-size: 2.5rem;
        text-align: center;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .subtitle {
        text-align: center;
        color: rgba(255, 255, 255, 0.9);
        margin-top: 0.5rem;
        font-size: 1.2rem;
      }

      .lesson-content {
        background: white;
        margin: 2rem auto;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        overflow: hidden;
        max-width: 1000px;
        position: relative;
      }

      .section {
        padding: 40px 50px;
        border-bottom: 1px solid #f0f0f0;
      }

      .section:last-child {
        border-bottom: none;
      }

      .section h2 {
        color: #2c3e50;
        font-size: 2rem;
        margin-bottom: 1rem;
        position: relative;
        padding-left: 20px;
      }

      .section h2::before {
        content: "";
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%);
        width: 5px;
        height: 30px;
        background: linear-gradient(45deg, #667eea, #764ba2);
        border-radius: 3px;
      }

      .section h3 {
        color: #34495e;
        font-size: 1.5rem;
        margin-top: 2rem;
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid #ecf0f1;
      }

      .theory {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-left: 5px solid #667eea;
        padding: 25px;
        margin: 25px 0;
        border-radius: 10px;
        position: relative;
      }

      .theory::before {
        content: "üí°";
        position: absolute;
        top: 15px;
        left: -15px;
        background: #667eea;
        width: 30px;
        height: 30px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .practice {
        background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
        border: 2px solid #4caf50;
        border-radius: 15px;
        padding: 30px;
        margin: 30px 0;
        position: relative;
        overflow: hidden;
      }

      .practice::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(76, 175, 80, 0.1) 0%,
          transparent 50%
        );
        animation: practiceGlow 3s ease-in-out infinite alternate;
      }

      @keyframes practiceGlow {
        0% {
          transform: rotate(0deg) scale(1);
        }
        100% {
          transform: rotate(180deg) scale(1.1);
        }
      }

      .code {
        background: #2c3e50;
        color: #ecf0f1;
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
        font-family: "Consolas", "Monaco", monospace;
        font-size: 0.95rem;
        line-height: 1.5;
        overflow-x: auto;
        position: relative;
      }

      .code-title {
        background: #34495e;
        color: #ecf0f1;
        padding: 8px 15px;
        margin: -20px -20px 20px -20px;
        font-weight: bold;
        border-radius: 10px 10px 0 0;
        border-bottom: 2px solid #667eea;
      }

      .demo {
        border: 3px solid #667eea;
        border-radius: 15px;
        padding: 30px;
        margin: 30px 0;
        background: linear-gradient(135deg, #f8f9ff 0%, #eef2ff 100%);
        text-align: center;
        position: relative;
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
      }

      .demo h4 {
        color: #667eea;
        margin-top: 0;
        font-size: 1.3rem;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      /* –õ–∏–¥–µ—Ä–±–æ—Ä–¥ —Å—Ç–∏–ª–∏ */
      .leaderboard {
        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        color: white;
        border-radius: 15px;
        padding: 25px;
        margin: 20px 0;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
      }

      .leaderboard-header {
        text-align: center;
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 2px solid rgba(255, 255, 255, 0.2);
      }

      .leaderboard-header h3 {
        margin: 0;
        color: #f39c12;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        font-size: 1.8rem;
        border: none;
      }

      .leaderboard-list {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .leaderboard-item {
        display: flex;
        align-items: center;
        padding: 15px 20px;
        margin: 10px 0;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .leaderboard-item:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateX(5px);
      }

      .leaderboard-item.top-1 {
        background: linear-gradient(135deg, #f39c12 0%, #f1c40f 100%);
        box-shadow: 0 10px 25px rgba(241, 196, 15, 0.3);
      }

      .leaderboard-item.top-2 {
        background: linear-gradient(135deg, #95a5a6 0%, #bdc3c7 100%);
        box-shadow: 0 10px 25px rgba(149, 165, 166, 0.3);
      }

      .leaderboard-item.top-3 {
        background: linear-gradient(135deg, #cd7f32 0%, #d4af37 100%);
        box-shadow: 0 10px 25px rgba(212, 175, 55, 0.3);
      }

      .rank {
        font-size: 1.5rem;
        font-weight: bold;
        margin-right: 20px;
        min-width: 40px;
        text-align: center;
      }

      .crown {
        font-size: 2rem;
        margin-right: 15px;
      }

      .player-info {
        flex: 1;
        text-align: left;
      }

      .player-name {
        font-size: 1.2rem;
        font-weight: bold;
        margin-bottom: 5px;
      }

      .player-stats {
        font-size: 0.9rem;
        opacity: 0.8;
      }

      .score {
        font-size: 1.4rem;
        font-weight: bold;
        color: #f39c12;
      }

      /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ */
      .leaderboard-item {
        animation: slideInLeft 0.6s ease forwards;
        opacity: 0;
        transform: translateX(-50px);
      }

      @keyframes slideInLeft {
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .leaderboard-item:nth-child(1) {
        animation-delay: 0.1s;
      }
      .leaderboard-item:nth-child(2) {
        animation-delay: 0.2s;
      }
      .leaderboard-item:nth-child(3) {
        animation-delay: 0.3s;
      }
      .leaderboard-item:nth-child(4) {
        animation-delay: 0.4s;
      }
      .leaderboard-item:nth-child(5) {
        animation-delay: 0.5s;
      }

      /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–∞ */
      .player-stats-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 15px;
        padding: 25px;
        margin: 20px 0;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        box-shadow: 0 15px 35px rgba(102, 126, 234, 0.3);
      }

      .stat-item {
        text-align: center;
        background: rgba(255, 255, 255, 0.1);
        padding: 20px;
        border-radius: 10px;
        backdrop-filter: blur(10px);
      }

      .stat-value {
        font-size: 2.5rem;
        font-weight: bold;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .stat-label {
        font-size: 1rem;
        opacity: 0.9;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      /* –ö–Ω–æ–ø–∫–∏ –¥–µ–º–æ */
      .demo-controls {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .demo-btn {
        background: linear-gradient(45deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 25px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
      }

      .demo-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      }

      .demo-btn:active {
        transform: translateY(0);
      }

      .demo-btn.success {
        background: linear-gradient(45deg, #4caf50, #45a049);
      }

      .demo-btn.warning {
        background: linear-gradient(45deg, #ff9800, #f57c00);
      }

      .demo-btn.danger {
        background: linear-gradient(45deg, #f44336, #d32f2f);
      }

      /* –°–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤ */
      .competition-arena {
        background: #f8f9fa;
        border: 2px solid #667eea;
        border-radius: 15px;
        padding: 25px;
        margin: 20px 0;
      }

      .versus-display {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin: 20px 0;
        flex-wrap: wrap;
        gap: 20px;
      }

      .player-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        border-radius: 15px;
        text-align: center;
        min-width: 200px;
        position: relative;
        overflow: hidden;
      }

      .player-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: conic-gradient(
          from 0deg,
          transparent,
          rgba(255, 255, 255, 0.1),
          transparent
        );
        animation: playerCardRotate 3s linear infinite;
      }

      @keyframes playerCardRotate {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .player-card.winner {
        background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
        transform: scale(1.1);
      }

      .player-avatar {
        font-size: 3rem;
        margin-bottom: 10px;
      }

      .player-name {
        font-size: 1.2rem;
        font-weight: bold;
        margin-bottom: 10px;
        position: relative;
        z-index: 1;
      }

      .player-score {
        font-size: 2rem;
        font-weight: bold;
        position: relative;
        z-index: 1;
      }

      .vs-separator {
        font-size: 3rem;
        font-weight: bold;
        color: #667eea;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .next-lesson {
        display: inline-block;
        background: linear-gradient(45deg, #4caf50, #45a049);
        color: white;
        text-decoration: none;
        padding: 15px 30px;
        border-radius: 25px;
        font-weight: bold;
        text-align: center;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        margin-top: 20px;
      }

      .next-lesson:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(76, 175, 80, 0.4);
      }

      .filter-tabs {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .filter-tab {
        padding: 10px 20px;
        background: rgba(255, 255, 255, 0.1);
        border: none;
        border-radius: 20px;
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .filter-tab.active {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px);
      }

      @media (max-width: 768px) {
        .container {
          padding: 0 15px;
        }

        .section {
          padding: 30px 25px;
        }

        .header h1 {
          font-size: 2rem;
        }

        .demo-controls {
          flex-direction: column;
          align-items: center;
        }

        .versus-display {
          flex-direction: column;
        }

        .vs-separator {
          transform: rotate(90deg);
        }
      }
    </style>
  </head>

  <body>
    <div class="header">
      <div class="container">
        <h1>üèÜ –õ–∏–¥–µ—Ä–±–æ—Ä–¥—ã –∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è</h1>
        <div class="subtitle">
          –ß–∞—Å—Ç—å 2: –°–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏
        </div>
      </div>
    </div>

    <div class="lesson-content">
      <div class="section">
        <h2>ü•á –ß—Ç–æ —Ç–∞–∫–æ–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥—ã?</h2>

        <div class="theory">
          <h3>–õ–∏–¥–µ—Ä–±–æ—Ä–¥ –∫–∞–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–æ—Ç–∏–≤–∞—Ü–∏–∏</h3>
          <p>
            –õ–∏–¥–µ—Ä–±–æ—Ä–¥ (—Ç–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤) ‚Äî —ç—Ç–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –ø–æ
            –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –ø–æ–∫–∞–∑–∞—Ç–µ–ª—é. –≠—Ç–æ –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –º–æ—â–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
            –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∂–µ–ª–∞–Ω–∏—è –ª—é–¥–µ–π
            —Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç—å—Å—è –∏ –±—ã—Ç—å –ª—É—á—à–∏–º–∏.
          </p>

          <h4>–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –ª–∏–¥–µ—Ä–±–æ—Ä–¥–æ–≤:</h4>
          <ul>
            <li>
              <strong>–°–æ—Ü–∏–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ</strong> ‚Äî –º—ã –æ—Ü–µ–Ω–∏–≤–∞–µ–º —Å–µ–±—è
              –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥—Ä—É–≥–∏—Ö
            </li>
            <li>
              <strong>–ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è</strong> ‚Äî —Å—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –ø—Ä–µ–≤–∑–æ–π—Ç–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤
            </li>
            <li>
              <strong>–°—Ç–∞—Ç—É—Å</strong> ‚Äî –≤—ã—Å–æ–∫–æ–µ –º–µ—Å—Ç–æ –¥–∞–µ—Ç —Å–æ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ
            </li>
            <li>
              <strong>–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å</strong> ‚Äî –ø–æ–Ω—è—Ç–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å
            </li>
          </ul>
        </div>

        <div
          style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
          "
        >
          <div
            style="
              background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
              color: white;
              padding: 20px;
              border-radius: 15px;
            "
          >
            <h4 style="margin-top: 0">‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã</h4>
            <ul style="margin: 0; padding-left: 20px">
              <li>–î–µ–º–æ—Ç–∏–≤–∞—Ü–∏—è —Å–ª–∞–±—ã—Ö –∏–≥—Ä–æ–∫–æ–≤</li>
              <li>–ß–∏—Ç–µ—Ä—Å—Ç–≤–æ –∏ –æ–±–º–∞–Ω</li>
              <li>–°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π —Ä–∞–∑—Ä—ã–≤ –º–µ–∂–¥—É –ª–∏–¥–µ—Ä–∞–º–∏</li>
            </ul>
          </div>
          <div
            style="
              background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
              color: white;
              padding: 20px;
              border-radius: 15px;
            "
          >
            <h4 style="margin-top: 0">‚úÖ –†–µ—à–µ–Ω–∏—è</h4>
            <ul style="margin: 0; padding-left: 20px">
              <li>–†–∞–∑–Ω—ã–µ –ª–∏–≥–∏ –ø–æ —É—Ä–æ–≤–Ω—é</li>
              <li>–°–∏—Å—Ç–µ–º–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</li>
              <li>–õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>üìã –°–æ–∑–¥–∞–Ω–∏–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞</h2>

        <div class="theory">
          <h3>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
          <p>
            –î–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ –Ω—É–∂–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö,
            –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª–∏—Ç –±—ã—Å—Ç—Ä–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å, —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å
            —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–≥—Ä–æ–∫–æ–≤.
          </p>
        </div>

        <div class="code">
          <div class="code-title">–ö–ª–∞—Å—Å Leaderboard</div>
          class Leaderboard { constructor() { this.players = [];
          this.sortCriteria = 'score'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –æ—á–∫–∞–º
          this.filters = { timeRange: 'all', // all, week, month, today
          gameMode: 'all', // all, easy, medium, hard minGames: 0 // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ
          –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä }; } // –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞ addPlayer(playerData) { const
          existingPlayer = this.players.find(p => p.id === playerData.id); if
          (existingPlayer) { this.updatePlayerStats(existingPlayer, playerData);
          } else { this.players.push({ id: playerData.id, name: playerData.name,
          avatar: playerData.avatar || 'üë§', totalScore: playerData.score || 0,
          gamesPlayed: 1, gamesWon: playerData.won ? 1 : 0, averageAttempts:
          playerData.attempts || 0, bestTime: playerData.time || Infinity,
          lastPlayed: new Date(), winRate: playerData.won ? 100 : 0, streak:
          playerData.won ? 1 : 0, level: 1, achievements: [] }); }
          this.sortPlayers(); } // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–≥—Ä–æ–∫–∞
          updatePlayerStats(player, gameData) { player.totalScore +=
          gameData.score || 0; player.gamesPlayed++; if (gameData.won) {
          player.gamesWon++; player.streak++; } else { player.streak = 0; } //
          –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ä–µ–¥–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ player.winRate =
          Math.round((player.gamesWon / player.gamesPlayed) * 100); // –û–±–Ω–æ–≤–ª—è–µ–º
          –ª—É—á—à–µ–µ –≤—Ä–µ–º—è if (gameData.time && gameData.time < player.bestTime) {
          player.bestTime = gameData.time; } // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
          –ø–æ–ø—ã—Ç–æ–∫ const totalAttempts = (player.averageAttempts *
          (player.gamesPlayed - 1)) + (gameData.attempts || 0);
          player.averageAttempts = Math.round(totalAttempts /
          player.gamesPlayed); player.lastPlayed = new Date(); } // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
          –∏–≥—Ä–æ–∫–æ–≤ sortPlayers() { this.players.sort((a, b) => { switch
          (this.sortCriteria) { case 'score': return b.totalScore -
          a.totalScore; case 'winRate': return b.winRate - a.winRate; case
          'games': return b.gamesPlayed - a.gamesPlayed; case 'streak': return
          b.streak - a.streak; case 'time': return a.bestTime - b.bestTime;
          default: return b.totalScore - a.totalScore; } }); // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–Ω–≥–∏
          this.players.forEach((player, index) => { player.rank = index + 1; });
          } // –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤ getTopPlayers(count = 10) { return
          this.players.slice(0, count); } // –ù–∞–π—Ç–∏ –∏–≥—Ä–æ–∫–∞ –ø–æ ID
          getPlayerRank(playerId) { const player = this.players.find(p => p.id
          === playerId); return player ? player.rank : -1; } // –ü–æ–ª—É—á–∏—Ç—å –∏–≥—Ä–æ–∫–æ–≤
          –æ–∫–æ–ª–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ä–∞–Ω–≥–∞ getPlayersAround(targetRank, range = 2) {
          const startIndex = Math.max(0, targetRank - range - 1); const endIndex
          = Math.min(this.players.length, targetRank + range); return
          this.players.slice(startIndex, endIndex); } }
        </div>

        <div class="demo">
          <h4>–î–µ–º–æ: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ª–∏–¥–µ—Ä–±–æ—Ä–¥</h4>

          <div class="leaderboard">
            <div class="leaderboard-header">
              <h3>üèÜ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h3>

              <div class="filter-tabs">
                <button class="filter-tab active" onclick="changeSort('score')">
                  –ü–æ –æ—á–∫–∞–º
                </button>
                <button class="filter-tab" onclick="changeSort('winRate')">
                  –ü–æ –ø—Ä–æ—Ü–µ–Ω—Ç—É –ø–æ–±–µ–¥
                </button>
                <button class="filter-tab" onclick="changeSort('streak')">
                  –ü–æ —Å–µ—Ä–∏–∏
                </button>
                <button class="filter-tab" onclick="changeSort('time')">
                  –ü–æ –≤—Ä–µ–º–µ–Ω–∏
                </button>
              </div>
            </div>

            <ul class="leaderboard-list" id="leaderboard-list">
              <!-- –°–ø–∏—Å–æ–∫ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω JavaScript -->
            </ul>
          </div>

          <div class="demo-controls">
            <button class="demo-btn success" onclick="addRandomPlayer()">
              –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞
            </button>
            <button class="demo-btn warning" onclick="simulateGame()">
              –°—ã–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–≥—Ä—É
            </button>
            <button class="demo-btn danger" onclick="resetLeaderboard()">
              –°–±—Ä–æ—Å
            </button>
          </div>
        </div>

        <div class="code">
          <div class="code-title">–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞</div>
          function renderLeaderboard(players) { const container =
          document.getElementById('leaderboard-list'); container.innerHTML = '';
          players.forEach((player, index) => { const listItem =
          document.createElement('li'); listItem.className = `leaderboard-item
          ${getTopClass(index + 1)}`; const rankDisplay = getRankDisplay(index +
          1); listItem.innerHTML = ` ${rankDisplay}
          <div class="player-info">
            <div class="player-name">${player.avatar} ${player.name}</div>
            <div class="player-stats">
              ${player.gamesPlayed} –∏–≥—Ä ‚Ä¢ ${player.winRate}% –ø–æ–±–µ–¥ ‚Ä¢ —Å–µ—Ä–∏—è:
              ${player.streak}
            </div>
          </div>
          <div class="score">${player.totalScore.toLocaleString()}</div>
          `; // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è listItem.style.animationDelay = `${index *
          0.1}s`; container.appendChild(listItem); }); } function
          getRankDisplay(rank) { switch (rank) { case 1: return '
          <div class="crown">üëë</div>
          '; case 2: return '
          <div class="crown">ü•à</div>
          '; case 3: return '
          <div class="crown">ü•â</div>
          '; default: return `
          <div class="rank">${rank}</div>
          `; } } function getTopClass(rank) { switch (rank) { case 1: return
          'top-1'; case 2: return 'top-2'; case 3: return 'top-3'; default:
          return ''; } }
        </div>
      </div>

      <div class="section">
        <h2>‚öîÔ∏è –°–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</h2>

        <div class="theory">
          <h3>PvP (Player vs Player) —Ä–µ–∂–∏–º—ã</h3>
          <p>
            –°–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –¥–æ–±–∞–≤–ª—è—é—Ç –∞–∑–∞—Ä—Ç –∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—É—é
            –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å. –ò–≥—Ä–æ–∫–∏ –º–æ–≥—É—Ç —Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç—å—Å—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º –Ω–∞–ø—Ä—è–º—É—é,
            —á—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –±–æ–ª–µ–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ —ç–º–æ—Ü–∏–∏.
          </p>

          <h4>–¢–∏–ø—ã PvP —Ä–µ–∂–∏–º–æ–≤:</h4>
          <ul>
            <li><strong>–î—É—ç–ª—å</strong> ‚Äî –æ–¥–∏–Ω –Ω–∞ –æ–¥–∏–Ω</li>
            <li><strong>–¢—É—Ä–Ω–∏—Ä</strong> ‚Äî –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞—É–Ω–¥–æ–≤ –Ω–∞ –≤—ã–±—ã–≤–∞–Ω–∏–µ</li>
            <li><strong>–ú–∞—Ä–∞—Ñ–æ–Ω</strong> ‚Äî –∫—Ç–æ –±–æ–ª—å—à–µ –∑–∞ –≤—Ä–µ–º—è</li>
            <li><strong>–°–ø—Ä–∏–Ω—Ç</strong> ‚Äî –∫—Ç–æ –±—ã—Å—Ç—Ä–µ–µ</li>
          </ul>
        </div>

        <div class="demo">
          <h4>–î–µ–º–æ: –î—É—ç–ª—å –∏–≥—Ä–æ–∫–æ–≤</h4>

          <div class="competition-arena">
            <h3 style="text-align: center; color: #667eea; margin-top: 0">
              ‚öîÔ∏è –ê—Ä–µ–Ω–∞ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π
            </h3>

            <div class="versus-display">
              <div class="player-card" id="player1-card">
                <div class="player-avatar">üéØ</div>
                <div class="player-name">–ò–≥—Ä–æ–∫ 1</div>
                <div class="player-score" id="player1-score">0</div>
              </div>

              <div class="vs-separator">VS</div>

              <div class="player-card" id="player2-card">
                <div class="player-avatar">üé≤</div>
                <div class="player-name">–ò–≥—Ä–æ–∫ 2</div>
                <div class="player-score" id="player2-score">0</div>
              </div>
            </div>

            <div style="text-align: center; margin: 20px 0">
              <div
                id="duel-status"
                style="font-size: 1.2rem; color: #667eea; margin-bottom: 15px"
              >
                –ì–æ—Ç–æ–≤—ã –∫ –¥—É—ç–ª–∏?
              </div>
              <div style="color: #666; margin-bottom: 20px">
                –ü–µ—Ä–≤—ã–π –¥–æ 3 –ø–æ–±–µ–¥
              </div>
            </div>

            <div class="demo-controls">
              <button
                class="demo-btn"
                onclick="startDuel()"
                id="start-duel-btn"
              >
                –ù–∞—á–∞—Ç—å –¥—É—ç–ª—å
              </button>
              <button
                class="demo-btn success"
                onclick="winRound(1)"
                style="display: none"
                id="p1-win-btn"
              >
                –ü–æ–±–µ–¥–∞ –∏–≥—Ä–æ–∫–∞ 1
              </button>
              <button
                class="demo-btn warning"
                onclick="winRound(2)"
                style="display: none"
                id="p2-win-btn"
              >
                –ü–æ–±–µ–¥–∞ –∏–≥—Ä–æ–∫–∞ 2
              </button>
              <button class="demo-btn danger" onclick="resetDuel()">
                –°–±—Ä–æ—Å
              </button>
            </div>
          </div>
        </div>

        <div class="code">
          <div class="code-title">–°–∏—Å—Ç–µ–º–∞ –¥—É—ç–ª–µ–π</div>
          class DuelSystem { constructor() { this.player1 = { name: '–ò–≥—Ä–æ–∫ 1',
          score: 0, avatar: 'üéØ' }; this.player2 = { name: '–ò–≥—Ä–æ–∫ 2', score: 0,
          avatar: 'üé≤' }; this.winCondition = 3; // –ü–µ—Ä–≤—ã–π –¥–æ 3 –ø–æ–±–µ–¥
          this.isActive = false; this.winner = null; } startDuel() {
          this.isActive = true; this.winner = null; this.updateDisplay();
          this.showMessage('–î—É—ç–ª—å –Ω–∞—á–∞–ª–∞—Å—å! –£–¥–∞—á–∏!'); } winRound(playerNumber) {
          if (!this.isActive) return; const player = playerNumber === 1 ?
          this.player1 : this.player2; player.score++; this.checkWinner();
          this.updateDisplay(); this.createVictoryEffect(playerNumber); if
          (this.winner) { this.endDuel(); } else {
          this.showMessage(`${player.name} –≤—ã–∏–≥—Ä–∞–ª —Ä–∞—É–Ω–¥!`); } } checkWinner() {
          if (this.player1.score >= this.winCondition) { this.winner =
          this.player1; } else if (this.player2.score >= this.winCondition) {
          this.winner = this.player2; } } endDuel() { this.isActive = false;
          this.showMessage(`üéâ ${this.winner.name} –ø–æ–±–µ–∂–¥–∞–µ—Ç –≤ –¥—É—ç–ª–∏!`);
          this.highlightWinner(); // –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
          this.recordDuelResult(); } recordDuelResult() { const winnerData = {
          id: this.winner === this.player1 ? 'player1' : 'player2', name:
          this.winner.name, score: 100, // –û—á–∫–∏ –∑–∞ –ø–æ–±–µ–¥—É –≤ –¥—É—ç–ª–∏ won: true,
          attempts: this.winner.score, time: Date.now() }; // –ó–¥–µ—Å—å –±—ã –¥–æ–±–∞–≤–∏–ª–∏
          –≤ –Ω–∞—Å—Ç–æ—è—â—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç –¥—É—ç–ª–∏ –∑–∞–ø–∏—Å–∞–Ω:',
          winnerData); } reset() { this.player1.score = 0; this.player2.score =
          0; this.isActive = false; this.winner = null; this.updateDisplay();
          this.showMessage('–ì–æ—Ç–æ–≤—ã –∫ –¥—É—ç–ª–∏?'); } highlightWinner() { const
          winnerCard = this.winner === this.player1 ?
          document.getElementById('player1-card') :
          document.getElementById('player2-card');
          winnerCard.classList.add('winner'); setTimeout(() => {
          winnerCard.classList.remove('winner'); }, 3000); } }
        </div>

        <div class="practice">
          <h3>üéØ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h3>
          <p><strong>–°–æ–∑–¥–∞–π—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π:</strong></p>
          <ol>
            <li>–î–æ–±–∞–≤—å—Ç–µ —Ç—É—Ä–Ω–∏—Ä–Ω—É—é —Å–µ—Ç–∫—É –Ω–∞ 8 –∏–≥—Ä–æ–∫–æ–≤</li>
            <li>–°–æ–∑–¥–∞–π—Ç–µ —Å–∏—Å—Ç–µ–º—É —Å—Ç–∞–≤–æ–∫ (–≤–Ω—É—Ç—Ä–∏–∏–≥—Ä–æ–≤–∞—è –≤–∞–ª—é—Ç–∞)</li>
            <li>–†–µ–∞–ª–∏–∑—É–π—Ç–µ –∑—Ä–∏—Ç–µ–ª—å—Å–∫—É—é —Å–∏—Å—Ç–µ–º—É (–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ –¥—É—ç–ª—è–º–∏)</li>
            <li>–î–æ–±–∞–≤—å—Ç–µ —á–∞—Ç –¥–ª—è –æ–±—â–µ–Ω–∏—è –∏–≥—Ä–æ–∫–æ–≤</li>
          </ol>

          <div class="code">
            <div class="code-title">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</div>
            class TournamentSystem { constructor(players) { this.players =
            [...players]; this.rounds = this.generateBracket(players);
            this.currentRound = 0; this.matches = []; } generateBracket(players)
            { const rounds = []; let currentPlayers = [...players]; while
            (currentPlayers.length > 1) { const matches = []; // –°–æ–∑–¥–∞–µ–º –ø–∞—Ä—ã
            for (let i = 0; i < currentPlayers.length; i += 2) { if (i + 1 <
            currentPlayers.length) { matches.push({ player1: currentPlayers[i],
            player2: currentPlayers[i + 1], winner: null, completed: false }); }
            } rounds.push(matches); currentPlayers = new
            Array(Math.ceil(currentPlayers.length / 2)); } return rounds; } }
          </div>
        </div>
      </div>

      <div class="section">
        <h2>üìä –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>

        <div class="theory">
          <h3>–í–∞–∂–Ω–æ—Å—Ç—å –ª–∏—á–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</h3>
          <p>
            –ü–æ–º–∏–º–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –∏–≥—Ä–æ–∫–∞–º–∏, –≤–∞–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏—á–Ω—ã–π
            –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥–æ–≥–æ –∏–≥—Ä–æ–∫–∞. –≠—Ç–æ –º–æ—Ç–∏–≤–∏—Ä—É–µ—Ç –¥–∞–∂–µ —Ç–µ—Ö, –∫—Ç–æ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤
            —Ç–æ–ø–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞.
          </p>
        </div>

        <div class="demo">
          <h4>–î–µ–º–æ: –ö–∞—Ä—Ç–æ—á–∫–∞ –∏–≥—Ä–æ–∫–∞</h4>

          <div class="player-stats-card">
            <div class="stat-item">
              <div class="stat-value" id="user-rank">15</div>
              <div class="stat-label">–ú–µ—Å—Ç–æ –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="user-score">2,540</div>
              <div class="stat-label">–û–±—â–∏–µ –æ—á–∫–∏</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="user-games">42</div>
              <div class="stat-label">–ò–≥—Ä —Å—ã–≥—Ä–∞–Ω–æ</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="user-winrate">73%</div>
              <div class="stat-label">–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="user-streak">8</div>
              <div class="stat-label">–¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="user-besttime">23s</div>
              <div class="stat-label">–õ—É—á—à–µ–µ –≤—Ä–µ–º—è</div>
            </div>
          </div>

          <div class="demo-controls">
            <button class="demo-btn success" onclick="improveStats()">
              –£–ª—É—á—à–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            </button>
            <button class="demo-btn warning" onclick="randomizeStats()">
              –°–ª—É—á–∞–π–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            </button>
          </div>
        </div>

        <div class="code">
          <div class="code-title">–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</div>
          function updateStatWithAnimation(elementId, newValue, duration = 1000)
          { const element = document.getElementById(elementId); const startValue
          = parseInt(element.textContent.replace(/[^\d]/g, '')) || 0; const
          endValue = typeof newValue === 'number' ? newValue :
          parseInt(newValue.replace(/[^\d]/g, '')) || 0; const startTime =
          Date.now(); function animate() { const elapsed = Date.now() -
          startTime; const progress = Math.min(elapsed / duration, 1); // Easing
          —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏ const easedProgress = 1 - Math.pow(1 - progress,
          3); const currentValue = Math.round(startValue + (endValue -
          startValue) * easedProgress); // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ let displayValue
          = currentValue.toLocaleString(); // –î–æ–±–∞–≤–ª—è–µ–º —Å—É—Ñ—Ñ–∏–∫—Å—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ if
          (elementId.includes('winrate') || elementId.includes('percent')) {
          displayValue += '%'; } else if (elementId.includes('time')) {
          displayValue += 's'; } element.textContent = displayValue; // –≠—Ñ—Ñ–µ–∫—Ç
          –∏–∑–º–µ–Ω–µ–Ω–∏—è element.style.color = progress < 1 ? '#4caf50' : '';
          element.style.transform = progress < 1 ? 'scale(1.1)' : 'scale(1)'; if
          (progress < 1) { requestAnimationFrame(animate); } else { //
          –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Å—Ç–∏–ª—å setTimeout(() => { element.style.color = '';
          element.style.transform = ''; }, 200); } } animate(); }
        </div>
      </div>

      <div style="text-align: center; margin-top: 50px">
        <a href="guess-lesson-5b-part3.html" class="next-lesson">
          –°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å: –ß–µ–ª–ª–µ–Ω–¥–∂–∏ –∏ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –º–æ—Ç–∏–≤–∞—Ü–∏—è ‚Üí
        </a>
      </div>
    </div>

    <script>
      // –°–∏—Å—Ç–µ–º–∞ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
      class Leaderboard {
        constructor() {
          this.players = [];
          this.sortCriteria = "score";
          this.generateSampleData();
        }

        generateSampleData() {
          const names = [
            "–ê–ª–µ–∫—Å",
            "–ú–∞—Ä–∏—è",
            "–î–º–∏—Ç—Ä–∏–π",
            "–ê–Ω–Ω–∞",
            "–°–µ—Ä–≥–µ–π",
            "–ï–ª–µ–Ω–∞",
            "–ò–≥–æ—Ä—å",
            "–û–ª—å–≥–∞",
          ];
          const avatars = ["üéØ", "üé≤", "üéÆ", "üé™", "üé®", "üé≠", "üé∏", "üé§"];

          for (let i = 0; i < 8; i++) {
            this.players.push({
              id: `player_${i}`,
              name: names[i],
              avatar: avatars[i],
              totalScore: Math.floor(Math.random() * 5000) + 1000,
              gamesPlayed: Math.floor(Math.random() * 50) + 10,
              gamesWon: 0,
              winRate: Math.floor(Math.random() * 40) + 60,
              streak: Math.floor(Math.random() * 15),
              bestTime: Math.floor(Math.random() * 60) + 15,
              rank: 0,
            });

            this.players[i].gamesWon = Math.floor(
              (this.players[i].gamesPlayed * this.players[i].winRate) / 100
            );
          }

          this.sortPlayers();
        }

        addPlayer() {
          const names = ["–ù–æ–≤–∏—á–æ–∫", "–ü—Ä–æ", "–ì–µ–Ω–∏–π", "–ú–∞—Å—Ç–µ—Ä", "–≠–∫—Å–ø–µ—Ä—Ç"];
          const avatars = ["üöÄ", "‚≠ê", "üíé", "üèÖ", "üëë"];

          const newPlayer = {
            id: `player_${Date.now()}`,
            name: names[Math.floor(Math.random() * names.length)],
            avatar: avatars[Math.floor(Math.random() * avatars.length)],
            totalScore: Math.floor(Math.random() * 2000) + 500,
            gamesPlayed: Math.floor(Math.random() * 20) + 5,
            gamesWon: 0,
            winRate: Math.floor(Math.random() * 30) + 50,
            streak: Math.floor(Math.random() * 8),
            bestTime: Math.floor(Math.random() * 45) + 20,
            rank: 0,
          };

          newPlayer.gamesWon = Math.floor(
            (newPlayer.gamesPlayed * newPlayer.winRate) / 100
          );
          this.players.push(newPlayer);
          this.sortPlayers();
          this.renderLeaderboard();
        }

        sortPlayers() {
          this.players.sort((a, b) => {
            switch (this.sortCriteria) {
              case "score":
                return b.totalScore - a.totalScore;
              case "winRate":
                return b.winRate - a.winRate;
              case "streak":
                return b.streak - a.streak;
              case "time":
                return a.bestTime - b.bestTime;
              default:
                return b.totalScore - a.totalScore;
            }
          });

          this.players.forEach((player, index) => {
            player.rank = index + 1;
          });
        }

        renderLeaderboard() {
          const container = document.getElementById("leaderboard-list");
          container.innerHTML = "";

          this.players.slice(0, 10).forEach((player, index) => {
            const listItem = document.createElement("li");
            listItem.className = `leaderboard-item ${this.getTopClass(
              index + 1
            )}`;

            const rankDisplay = this.getRankDisplay(index + 1);
            const scoreDisplay = this.getScoreDisplay(player);

            listItem.innerHTML = `
                        ${rankDisplay}
                        <div class="player-info">
                            <div class="player-name">
                                ${player.avatar} ${player.name}
                            </div>
                            <div class="player-stats">
                                ${player.gamesPlayed} –∏–≥—Ä ‚Ä¢ ${player.winRate}% –ø–æ–±–µ–¥ ‚Ä¢ —Å–µ—Ä–∏—è: ${player.streak}
                            </div>
                        </div>
                        <div class="score">${scoreDisplay}</div>
                    `;

            listItem.style.animationDelay = `${index * 0.1}s`;
            container.appendChild(listItem);
          });
        }

        getRankDisplay(rank) {
          switch (rank) {
            case 1:
              return '<div class="crown">üëë</div>';
            case 2:
              return '<div class="crown">ü•à</div>';
            case 3:
              return '<div class="crown">ü•â</div>';
            default:
              return `<div class="rank">${rank}</div>`;
          }
        }

        getTopClass(rank) {
          switch (rank) {
            case 1:
              return "top-1";
            case 2:
              return "top-2";
            case 3:
              return "top-3";
            default:
              return "";
          }
        }

        getScoreDisplay(player) {
          switch (this.sortCriteria) {
            case "winRate":
              return `${player.winRate}%`;
            case "streak":
              return `${player.streak}`;
            case "time":
              return `${player.bestTime}s`;
            default:
              return player.totalScore.toLocaleString();
          }
        }

        changeSort(criteria) {
          this.sortCriteria = criteria;
          this.sortPlayers();
          this.renderLeaderboard();

          // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É
          document
            .querySelectorAll(".filter-tab")
            .forEach((tab) => tab.classList.remove("active"));
          event.target.classList.add("active");
        }

        simulateGame() {
          if (this.players.length === 0) return;

          const randomPlayer =
            this.players[Math.floor(Math.random() * this.players.length)];

          // –°–∏–º—É–ª–∏—Ä—É–µ–º –∏–≥—Ä—É
          randomPlayer.gamesPlayed++;
          const won = Math.random() > 0.3;

          if (won) {
            randomPlayer.gamesWon++;
            randomPlayer.streak++;
            randomPlayer.totalScore += Math.floor(Math.random() * 100) + 50;
          } else {
            randomPlayer.streak = 0;
          }

          randomPlayer.winRate = Math.round(
            (randomPlayer.gamesWon / randomPlayer.gamesPlayed) * 100
          );

          this.sortPlayers();
          this.renderLeaderboard();
        }
      }

      // –°–∏—Å—Ç–µ–º–∞ –¥—É—ç–ª–µ–π
      class DuelSystem {
        constructor() {
          this.player1 = { name: "–ò–≥—Ä–æ–∫ 1", score: 0, avatar: "üéØ" };
          this.player2 = { name: "–ò–≥—Ä–æ–∫ 2", score: 0, avatar: "üé≤" };
          this.winCondition = 3;
          this.isActive = false;
          this.winner = null;
        }

        startDuel() {
          this.isActive = true;
          this.winner = null;
          this.updateButtons();
          this.showMessage("–î—É—ç–ª—å –Ω–∞—á–∞–ª–∞—Å—å! –ö–ª–∏–∫–∞–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ø–æ–±–µ–¥—ã!");
        }

        winRound(playerNumber) {
          if (!this.isActive) return;

          const player = playerNumber === 1 ? this.player1 : this.player2;
          player.score++;

          this.updateDisplay();

          if (player.score >= this.winCondition) {
            this.winner = player;
            this.endDuel();
          } else {
            this.showMessage(
              `${player.name} –≤—ã–∏–≥—Ä–∞–ª —Ä–∞—É–Ω–¥! (${player.score}/${this.winCondition})`
            );
          }
        }

        endDuel() {
          this.isActive = false;
          this.showMessage(`üéâ ${this.winner.name} –ø–æ–±–µ–∂–¥–∞–µ—Ç –≤ –¥—É—ç–ª–∏!`);
          this.highlightWinner();
          this.updateButtons();
        }

        updateDisplay() {
          document.getElementById("player1-score").textContent =
            this.player1.score;
          document.getElementById("player2-score").textContent =
            this.player2.score;
        }

        updateButtons() {
          const startBtn = document.getElementById("start-duel-btn");
          const p1Btn = document.getElementById("p1-win-btn");
          const p2Btn = document.getElementById("p2-win-btn");

          if (this.isActive) {
            startBtn.style.display = "none";
            p1Btn.style.display = "inline-block";
            p2Btn.style.display = "inline-block";
          } else {
            startBtn.style.display = "inline-block";
            p1Btn.style.display = "none";
            p2Btn.style.display = "none";
          }
        }

        highlightWinner() {
          const winnerCard =
            this.winner === this.player1
              ? document.getElementById("player1-card")
              : document.getElementById("player2-card");

          winnerCard.classList.add("winner");

          setTimeout(() => {
            winnerCard.classList.remove("winner");
          }, 3000);
        }

        showMessage(message) {
          document.getElementById("duel-status").textContent = message;
        }

        reset() {
          this.player1.score = 0;
          this.player2.score = 0;
          this.isActive = false;
          this.winner = null;
          this.updateDisplay();
          this.updateButtons();
          this.showMessage("–ì–æ—Ç–æ–≤—ã –∫ –¥—É—ç–ª–∏?");

          document.getElementById("player1-card").classList.remove("winner");
          document.getElementById("player2-card").classList.remove("winner");
        }
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
      const leaderboard = new Leaderboard();
      const duelSystem = new DuelSystem();

      // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
      function changeSort(criteria) {
        leaderboard.changeSort(criteria);
      }

      function addRandomPlayer() {
        leaderboard.addPlayer();
      }

      function simulateGame() {
        leaderboard.simulateGame();
      }

      function resetLeaderboard() {
        leaderboard.players = [];
        leaderboard.generateSampleData();
        leaderboard.renderLeaderboard();
      }

      function startDuel() {
        duelSystem.startDuel();
      }

      function winRound(player) {
        duelSystem.winRound(player);
      }

      function resetDuel() {
        duelSystem.reset();
      }

      // –ê–Ω–∏–º–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
      function updateStatWithAnimation(elementId, newValue, duration = 1000) {
        const element = document.getElementById(elementId);
        const startValue =
          parseInt(element.textContent.replace(/[^\d]/g, "")) || 0;
        const endValue =
          typeof newValue === "number"
            ? newValue
            : parseInt(newValue.replace(/[^\d]/g, "")) || 0;

        const startTime = Date.now();

        function animate() {
          const elapsed = Date.now() - startTime;
          const progress = Math.min(elapsed / duration, 1);
          const easedProgress = 1 - Math.pow(1 - progress, 3);

          const currentValue = Math.round(
            startValue + (endValue - startValue) * easedProgress
          );

          let displayValue = currentValue.toLocaleString();

          if (elementId.includes("winrate")) {
            displayValue += "%";
          } else if (elementId.includes("besttime")) {
            displayValue += "s";
          }

          element.textContent = displayValue;
          element.style.color = progress < 1 ? "#4caf50" : "";
          element.style.transform = progress < 1 ? "scale(1.1)" : "scale(1)";

          if (progress < 1) {
            requestAnimationFrame(animate);
          } else {
            setTimeout(() => {
              element.style.color = "";
              element.style.transform = "";
            }, 200);
          }
        }

        animate();
      }

      function improveStats() {
        updateStatWithAnimation(
          "user-rank",
          Math.max(
            1,
            parseInt(document.getElementById("user-rank").textContent) -
              Math.floor(Math.random() * 5) -
              1
          )
        );
        updateStatWithAnimation(
          "user-score",
          parseInt(
            document.getElementById("user-score").textContent.replace(/,/g, "")
          ) +
            Math.floor(Math.random() * 500) +
            200
        );
        updateStatWithAnimation(
          "user-games",
          parseInt(document.getElementById("user-games").textContent) +
            Math.floor(Math.random() * 5) +
            1
        );
        updateStatWithAnimation(
          "user-winrate",
          Math.min(
            99,
            parseInt(document.getElementById("user-winrate").textContent) +
              Math.floor(Math.random() * 5) +
              1
          )
        );
        updateStatWithAnimation(
          "user-streak",
          parseInt(document.getElementById("user-streak").textContent) +
            Math.floor(Math.random() * 3) +
            1
        );
        updateStatWithAnimation(
          "user-besttime",
          Math.max(
            10,
            parseInt(document.getElementById("user-besttime").textContent) -
              Math.floor(Math.random() * 5) -
              1
          )
        );
      }

      function randomizeStats() {
        updateStatWithAnimation(
          "user-rank",
          Math.floor(Math.random() * 100) + 1
        );
        updateStatWithAnimation(
          "user-score",
          Math.floor(Math.random() * 5000) + 1000
        );
        updateStatWithAnimation(
          "user-games",
          Math.floor(Math.random() * 50) + 10
        );
        updateStatWithAnimation(
          "user-winrate",
          Math.floor(Math.random() * 40) + 60
        );
        updateStatWithAnimation("user-streak", Math.floor(Math.random() * 15));
        updateStatWithAnimation(
          "user-besttime",
          Math.floor(Math.random() * 60) + 15
        );
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
      leaderboard.renderLeaderboard();
    </script>
  </body>
</html>
