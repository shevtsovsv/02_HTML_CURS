<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üê¶ Flappy Bird - –£—á–µ–±–Ω–∞—è –∏–≥—Ä–∞</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Arial", sans-serif;
        background: linear-gradient(135deg, #87ceeb 0%, #98fb98 100%);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }

      .game-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        background: rgba(255, 255, 255, 0.1);
        padding: 30px;
        border-radius: 20px;
        backdrop-filter: blur(10px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
      }

      h1 {
        color: #2c3e50;
        font-size: 2.5rem;
        margin-bottom: 20px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      canvas {
        border: 3px solid #34495e;
        border-radius: 10px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        background: linear-gradient(
          to bottom,
          #87ceeb 0%,
          #98fb98 80%,
          #228b22 100%
        );
      }

      .controls {
        margin-top: 20px;
        text-align: center;
        color: #2c3e50;
        background: rgba(255, 255, 255, 0.8);
        padding: 15px 25px;
        border-radius: 15px;
      }

      .controls p {
        margin: 5px 0;
        font-weight: bold;
      }

      .score-display {
        position: absolute;
        top: 40px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 2rem;
        font-weight: bold;
        color: #fff;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        background: rgba(52, 73, 94, 0.7);
        padding: 10px 20px;
        border-radius: 25px;
      }

      .game-over {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(231, 76, 60, 0.95);
        color: white;
        padding: 30px;
        border-radius: 20px;
        text-align: center;
        display: none;
        backdrop-filter: blur(10px);
      }

      .start-screen {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(52, 152, 219, 0.95);
        color: white;
        padding: 30px;
        border-radius: 20px;
        text-align: center;
        backdrop-filter: blur(10px);
      }

      .btn {
        background: linear-gradient(45deg, #3498db, #2980b9);
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 25px;
        font-size: 1.1rem;
        font-weight: bold;
        cursor: pointer;
        margin: 10px;
        transition: all 0.3s ease;
      }

      .btn:hover {
        background: linear-gradient(45deg, #2980b9, #21618c);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
      }

      .back-button {
        position: absolute;
        top: 20px;
        left: 20px;
        background: rgba(255, 255, 255, 0.9);
        color: #2c3e50;
        border: none;
        padding: 10px 20px;
        border-radius: 20px;
        font-weight: bold;
        cursor: pointer;
        text-decoration: none;
        transition: all 0.3s ease;
      }

      .back-button:hover {
        background: white;
        transform: scale(1.05);
      }

      .difficulty-buttons {
        display: flex;
        gap: 10px;
        margin: 20px 0;
        flex-wrap: wrap;
        justify-content: center;
      }

      .difficulty-btn {
        background: linear-gradient(45deg, #27ae60, #229954);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 20px;
        font-size: 1rem;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        min-width: 100px;
      }

      .difficulty-btn:hover {
        background: linear-gradient(45deg, #229954, #1e8449);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
      }

      .difficulty-btn.selected {
        background: linear-gradient(45deg, #e74c3c, #c0392b);
        box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
      }

      .difficulty-btn.easy {
        background: linear-gradient(45deg, #27ae60, #229954);
      }

      .difficulty-btn.medium {
        background: linear-gradient(45deg, #f39c12, #e67e22);
      }

      .difficulty-btn.hard {
        background: linear-gradient(45deg, #e74c3c, #c0392b);
      }

      .difficulty-info {
        background: rgba(255, 255, 255, 0.9);
        padding: 15px;
        border-radius: 10px;
        margin: 15px 0;
        color: #2c3e50;
        font-size: 0.9rem;
      }

      @media (max-width: 768px) {
        canvas {
          width: 90vw;
          height: 60vh;
        }

        h1 {
          font-size: 2rem;
        }

        .game-container {
          padding: 20px;
        }
      }
    </style>
  </head>
  <body>
    <a href="../index.html" class="back-button">‚Üê –ö —É—Ä–æ–∫–∞–º</a>

    <div class="score-display" id="score">–°—á—ë—Ç: 0</div>

    <div class="game-container">
      <h1>üê¶ Flappy Bird</h1>
      <canvas id="gameCanvas" width="480" height="640"></canvas>

      <div class="controls">
        <p>üñ±Ô∏è –ö–ª–∏–∫ –º—ã—à–∫–æ–π –∏–ª–∏ –ü—Ä–æ–±–µ–ª - –ø—Ä—ã–∂–æ–∫</p>
        <p>üéØ –ü—Ä–æ–ª–µ—Ç–∞–π—Ç–µ –º–µ–∂–¥—É —Ç—Ä—É–±–∞–º–∏ –∏ –Ω–∞–±–∏—Ä–∞–π—Ç–µ –æ—á–∫–∏!</p>
      </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ä—Ç–∞ -->
    <div class="start-screen" id="startScreen">
      <h2>üê¶ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Flappy Bird!</h2>
      <p>–ü–æ–º–æ–≥–∏—Ç–µ –ø—Ç–∏—á–∫–µ –ø—Ä–æ–ª–µ—Ç–µ—Ç—å —á–µ—Ä–µ–∑ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è</p>
      <p>–ò–∑—É—á–∞–π—Ç–µ —Ñ–∏–∑–∏–∫—É –∏–≥—Ä –∏ Canvas API</p>

      <h3>–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:</h3>
      <div class="difficulty-buttons">
        <button
          class="difficulty-btn easy selected"
          onclick="selectDifficulty('easy')"
        >
          üòä –õ–µ–≥–∫–æ
        </button>
        <button
          class="difficulty-btn medium"
          onclick="selectDifficulty('medium')"
        >
          üòê –°—Ä–µ–¥–Ω–µ
        </button>
        <button class="difficulty-btn hard" onclick="selectDifficulty('hard')">
          üò§ –°–ª–æ–∂–Ω–æ
        </button>
      </div>

      <div class="difficulty-info" id="difficultyInfo">
        <strong>–õ–µ–≥–∫–∏–π —É—Ä–æ–≤–µ–Ω—å:</strong><br />
        ‚Ä¢ –ú–µ–¥–ª–µ–Ω–Ω–∞—è –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è<br />
        ‚Ä¢ –®–∏—Ä–æ–∫–∏–µ –ø—Ä–æ—Ö–æ–¥—ã –º–µ–∂–¥—É —Ç—Ä—É–±–∞–º–∏<br />
        ‚Ä¢ –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ç—Ä—É–±<br />
        ‚Ä¢ –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –æ—Å–Ω–æ–≤!
      </div>

      <button class="btn" onclick="startGame()">üöÄ –ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
      <p style="margin-top: 15px; font-size: 0.9rem; opacity: 0.8">
        –≠—Ç–∞ –∏–≥—Ä–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç: –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—é, —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è, –∞–Ω–∏–º–∞—Ü–∏—é –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        –∏–≥—Ä–æ–≤—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
      </p>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã -->
    <div class="game-over" id="gameOver">
      <h2>üí• –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</h2>
      <p id="finalScore">–í–∞—à —Å—á—ë—Ç: 0</p>
      <p id="bestScore">–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 0</p>
      <button class="btn" onclick="restartGame()">üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
      <button class="btn" onclick="showStartScreen()">üè† –í –º–µ–Ω—é</button>
    </div>

    <script>
      // ===========================================
      // –ö–û–ù–°–¢–ê–ù–¢–´ –ò –ù–ê–°–¢–†–û–ô–ö–ò –ò–ì–†–´
      // ===========================================

      const canvas = document.getElementById("gameCanvas");
      const ctx = canvas.getContext("2d");

      // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
      const DIFFICULTY_SETTINGS = {
        easy: {
          gravity: 0.4,
          jumpForce: -10,
          pipeSpeed: 2,
          pipeGap: 220,
          pipeFrequency: 150, // –∫–∞–¥—Ä—ã –º–µ–∂–¥—É —Ç—Ä—É–±–∞–º–∏
        },
        medium: {
          gravity: 0.6,
          jumpForce: -12,
          pipeSpeed: 3,
          pipeGap: 180,
          pipeFrequency: 120,
        },
        hard: {
          gravity: 0.8,
          jumpForce: -13,
          pipeSpeed: 4,
          pipeGap: 150,
          pipeFrequency: 100,
        },
      };

      // –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ª–µ–≥–∫–∏–π —É—Ä–æ–≤–µ–Ω—å)
      let currentDifficulty = "easy";
      let gameSettings = DIFFICULTY_SETTINGS[currentDifficulty];

      // –§–∏–∑–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (–±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
      const PIPE_WIDTH = 60; // –®–∏—Ä–∏–Ω–∞ —Ç—Ä—É–±—ã (–ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è)

      // ===========================================
      // –ò–ì–†–û–í–´–ï –û–ë–™–ï–ö–¢–´
      // ===========================================

      // –ü—Ç–∏—á–∫–∞ - –≥–ª–∞–≤–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂
      const bird = {
        x: 80, // –ü–æ–∑–∏—Ü–∏—è X (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)
        y: canvas.height / 2, // –ü–æ–∑–∏—Ü–∏—è Y (–Ω–∞—á–∞–ª—å–Ω–∞—è - —Ü–µ–Ω—Ç—Ä)
        width: 40, // –†–∞–∑–º–µ—Ä—ã –ø—Ç–∏—á–∫–∏
        height: 30,
        velocity: 0, // –°–∫–æ—Ä–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è/–≤–∑–ª–µ—Ç–∞

        // –ú–µ—Ç–æ–¥ –ø—Ä—ã–∂–∫–∞
        jump: function () {
          this.velocity = gameSettings.jumpForce;
        },

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–∑–∏–∫–∏ –ø—Ç–∏—á–∫–∏
        update: function () {
          this.velocity += gameSettings.gravity; // –ü—Ä–∏–º–µ–Ω—è–µ–º –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—é
          this.y += this.velocity; // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é

          // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞
          if (this.y < 0) this.y = 0;
          if (this.y > canvas.height - this.height) {
            this.y = canvas.height - this.height;
            this.velocity = 0;
          }
        },

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –ø—Ç–∏—á–∫–∏
        draw: function () {
          // –¢–µ–ª–æ –ø—Ç–∏—á–∫–∏
          ctx.fillStyle = "#FFD700";
          ctx.beginPath();
          ctx.arc(this.x + 20, this.y + 15, 18, 0, Math.PI * 2);
          ctx.fill();

          // –ì–ª–∞–∑
          ctx.fillStyle = "#000";
          ctx.beginPath();
          ctx.arc(this.x + 25, this.y + 10, 3, 0, Math.PI * 2);
          ctx.fill();

          // –ö–ª—é–≤
          ctx.fillStyle = "#FF6347";
          ctx.beginPath();
          ctx.moveTo(this.x + 35, this.y + 15);
          ctx.lineTo(this.x + 45, this.y + 18);
          ctx.lineTo(this.x + 35, this.y + 21);
          ctx.closePath();
          ctx.fill();

          // –ö—Ä—ã–ª–æ (–∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ)
          const wingAngle = Math.sin(Date.now() * 0.01) * 0.3;
          ctx.save();
          ctx.translate(this.x + 15, this.y + 20);
          ctx.rotate(wingAngle);
          ctx.fillStyle = "#FFA500";
          ctx.fillRect(-8, -5, 15, 10);
          ctx.restore();
        },
      };

      // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç—Ä—É–±
      let pipes = [];

      // ===========================================
      // –ò–ì–†–û–í–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
      // ===========================================

      let gameState = "start"; // 'start', 'playing', 'gameOver'
      let score = 0; // –¢–µ–∫—É—â–∏–π —Å—á—ë—Ç
      let bestScore = localStorage.getItem("flappyBestScore") || 0; // –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
      let frameCount = 0; // –°—á—ë—Ç—á–∏–∫ –∫–∞–¥—Ä–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä—É–±

      // ===========================================
      // –§–£–ù–ö–¶–ò–ò –°–û–ó–î–ê–ù–ò–Ø –ü–†–ï–ü–Ø–¢–°–¢–í–ò–ô
      // ===========================================

      // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –ø–∞—Ä—ã —Ç—Ä—É–±
      function createPipe() {
        const gapPosition =
          Math.random() * (canvas.height - gameSettings.pipeGap - 100) + 50;

        return {
          x: canvas.width,
          topHeight: gapPosition,
          bottomY: gapPosition + gameSettings.pipeGap,
          bottomHeight: canvas.height - (gapPosition + gameSettings.pipeGap),
          passed: false, // –§–ª–∞–≥ –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –æ—á–∫–æ–≤

          // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —Ç—Ä—É–±—ã
          update: function () {
            this.x -= gameSettings.pipeSpeed;
          },

          // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç—Ä—É–±—ã
          draw: function () {
            // –í–µ—Ä—Ö–Ω—è—è —Ç—Ä—É–±–∞
            this.drawPipe(this.x, 0, PIPE_WIDTH, this.topHeight, true);
            // –ù–∏–∂–Ω—è—è —Ç—Ä—É–±–∞
            this.drawPipe(
              this.x,
              this.bottomY,
              PIPE_WIDTH,
              this.bottomHeight,
              false
            );
          },

          // –ú–µ—Ç–æ–¥ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –æ–¥–Ω–æ–π —Ç—Ä—É–±—ã
          drawPipe: function (x, y, width, height, isTop) {
            // –û—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å —Ç—Ä—É–±—ã
            ctx.fillStyle = "#228B22";
            ctx.fillRect(x, y, width, height);

            // –ì—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è –æ–±—ä—ë–º–∞
            const gradient = ctx.createLinearGradient(x, 0, x + width, 0);
            gradient.addColorStop(0, "#32CD32");
            gradient.addColorStop(0.5, "#228B22");
            gradient.addColorStop(1, "#006400");
            ctx.fillStyle = gradient;
            ctx.fillRect(x, y, width, height);

            // –ó–∞–≥–ª—É—à–∫–∞ —Ç—Ä—É–±—ã
            const capHeight = 30;
            const capWidth = width + 10;
            const capX = x - 5;

            ctx.fillStyle = "#32CD32";
            if (isTop) {
              ctx.fillRect(capX, height - capHeight, capWidth, capHeight);
            } else {
              ctx.fillRect(capX, y, capWidth, capHeight);
            }

            // –û–±–≤–æ–¥–∫–∞
            ctx.strokeStyle = "#006400";
            ctx.lineWidth = 2;
            ctx.strokeRect(x, y, width, height);
          },
        };
      }

      // ===========================================
      // –§–£–ù–ö–¶–ò–ò –û–ë–ù–ê–†–£–ñ–ï–ù–ò–Ø –°–¢–û–õ–ö–ù–û–í–ï–ù–ò–ô
      // ===========================================

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –ø—Ç–∏—á–∫–∏ —Å —Ç—Ä—É–±–æ–π
      function checkCollision() {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ —ç–∫—Ä–∞–Ω–∞
        if (bird.y <= 0 || bird.y >= canvas.height - bird.height) {
          return true;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å —Ç—Ä—É–±–∞–º–∏
        for (let pipe of pipes) {
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –ø—Ç–∏—á–∫–∞ –≤ –æ–±–ª–∞—Å—Ç–∏ —Ç—Ä—É–±—ã –ø–æ X
          if (bird.x + bird.width > pipe.x && bird.x < pipe.x + PIPE_WIDTH) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –≤–µ—Ä—Ö–Ω–µ–π –∏–ª–∏ –Ω–∏–∂–Ω–µ–π —Ç—Ä—É–±–æ–π
            if (
              bird.y < pipe.topHeight ||
              bird.y + bird.height > pipe.bottomY
            ) {
              return true;
            }
          }
        }

        return false;
      }

      // ===========================================
      // –û–°–ù–û–í–ù–û–ô –ò–ì–†–û–í–û–ô –¶–ò–ö–õ
      // ===========================================

      function gameLoop() {
        // –û—á–∏—Å—Ç–∫–∞ canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        if (gameState === "playing") {
          // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ç–∏—á–∫–∏
          bird.update();

          // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç—Ä—É–± —Å —É—á—ë—Ç–æ–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
          frameCount++;
          if (frameCount % gameSettings.pipeFrequency === 0) {
            pipes.push(createPipe());
          }

          // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—Ä—É–±
          for (let i = pipes.length - 1; i >= 0; i--) {
            const pipe = pipes[i];
            pipe.update();

            // –£–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä—É–±, –∫–æ—Ç–æ—Ä—ã–µ —É—à–ª–∏ –∑–∞ —ç–∫—Ä–∞–Ω
            if (pipe.x + PIPE_WIDTH < 0) {
              pipes.splice(i, 1);
              continue;
            }

            // –ü–æ–¥—Å—á—ë—Ç –æ—á–∫–æ–≤
            if (!pipe.passed && pipe.x + PIPE_WIDTH < bird.x) {
              pipe.passed = true;
              score++;
              updateScore();

              // –ó–≤—É–∫–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
              playSound();
            }
          }

          // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
          if (checkCollision()) {
            gameOver();
          }
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤
        drawGame();

        // –ó–∞–ø—Ä–æ—Å —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–∞–¥—Ä–∞
        requestAnimationFrame(gameLoop);
      }

      // ===========================================
      // –§–£–ù–ö–¶–ò–ò –û–¢–†–ò–°–û–í–ö–ò
      // ===========================================

      function drawGame() {
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ñ–æ–Ω–∞ (–≥—Ä–∞–¥–∏–µ–Ω—Ç –Ω–µ–±–∞)
        const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
        gradient.addColorStop(0, "#87CEEB"); // –°–≤–µ—Ç–ª–æ-–≥–æ–ª—É–±–æ–π
        gradient.addColorStop(0.7, "#98FB98"); // –°–≤–µ—Ç–ª–æ-–∑–µ–ª—ë–Ω—ã–π
        gradient.addColorStop(1, "#228B22"); // –ó–µ–ª—ë–Ω—ã–π (–∑–µ–º–ª—è)

        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –æ–±–ª–∞–∫–æ–≤
        drawClouds();

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç—Ä—É–±
        for (let pipe of pipes) {
          pipe.draw();
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –ø—Ç–∏—á–∫–∏
        bird.draw();

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∑–µ–º–ª–∏
        drawGround();
      }

      // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –æ–±–ª–∞–∫–æ–≤
      function drawClouds() {
        ctx.fillStyle = "rgba(255, 255, 255, 0.8)";

        // –ù–µ—Å–∫–æ–ª—å–∫–æ –æ–±–ª–∞–∫–æ–≤ –≤ —Ä–∞–∑–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö
        const cloudPositions = [
          { x: 50, y: 50 },
          { x: 200, y: 80 },
          { x: 350, y: 40 },
          { x: 150, y: 120 },
        ];

        cloudPositions.forEach((cloud) => {
          ctx.beginPath();
          ctx.arc(cloud.x, cloud.y, 20, 0, Math.PI * 2);
          ctx.arc(cloud.x + 25, cloud.y, 30, 0, Math.PI * 2);
          ctx.arc(cloud.x + 50, cloud.y, 25, 0, Math.PI * 2);
          ctx.fill();
        });
      }

      // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∑–µ–º–ª–∏
      function drawGround() {
        const groundHeight = 30;
        const groundY = canvas.height - groundHeight;

        // –ó–µ–º–ª—è
        ctx.fillStyle = "#8B4513";
        ctx.fillRect(0, groundY, canvas.width, groundHeight);

        // –¢—Ä–∞–≤–∞
        ctx.fillStyle = "#228B22";
        for (let x = 0; x < canvas.width; x += 10) {
          const grassHeight = Math.random() * 8 + 5;
          ctx.fillRect(x, groundY - grassHeight, 3, grassHeight);
        }
      }

      // ===========================================
      // –£–ü–†–ê–í–õ–ï–ù–ò–ï –ò–ì–†–û–ô
      // ===========================================

      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞
      function handleInput() {
        if (gameState === "playing") {
          bird.jump();
        } else if (gameState === "start") {
          startGame();
        } else if (gameState === "gameOver") {
          restartGame();
        }
      }

      // –°–æ–±—ã—Ç–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ –º—ã—à–∏
      document.addEventListener("keydown", function (e) {
        if (e.code === "Space") {
          e.preventDefault();
          handleInput();
        }
      });

      canvas.addEventListener("click", handleInput);

      // ===========================================
      // –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –°–û–°–¢–û–Ø–ù–ò–ï–ú –ò–ì–†–´
      // ===========================================

      function startGame() {
        gameState = "playing";
        resetGame();
        document.getElementById("startScreen").style.display = "none";
      }

      function gameOver() {
        gameState = "gameOver";

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª—É—á—à–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        if (score > bestScore) {
          bestScore = score;
          localStorage.setItem("flappyBestScore", bestScore);
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã
        document.getElementById(
          "finalScore"
        ).textContent = `–í–∞—à —Å—á—ë—Ç: ${score}`;
        document.getElementById(
          "bestScore"
        ).textContent = `–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${bestScore}`;
        document.getElementById("gameOver").style.display = "block";
      }

      function restartGame() {
        resetGame();
        gameState = "playing";
        document.getElementById("gameOver").style.display = "none";
      }

      function showStartScreen() {
        gameState = "start";
        resetGame();
        document.getElementById("gameOver").style.display = "none";
        document.getElementById("startScreen").style.display = "block";
      }

      function resetGame() {
        // –°–±—Ä–æ—Å –ø—Ç–∏—á–∫–∏
        bird.y = canvas.height / 2;
        bird.velocity = 0;

        // –û—á–∏—Å—Ç–∫–∞ —Ç—Ä—É–±
        pipes = [];

        // –°–±—Ä–æ—Å —Å—á—ë—Ç–∞ –∏ —Å—á—ë—Ç—á–∏–∫–æ–≤
        score = 0;
        frameCount = 0;
        updateScore();
      }

      // ===========================================
      // –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –°–õ–û–ñ–ù–û–°–¢–¨–Æ
      // ===========================================

      function selectDifficulty(difficulty) {
        currentDifficulty = difficulty;
        gameSettings = DIFFICULTY_SETTINGS[difficulty];

        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        document.querySelectorAll(".difficulty-btn").forEach((btn) => {
          btn.classList.remove("selected");
        });
        document
          .querySelector(`.difficulty-btn.${difficulty}`)
          .classList.add("selected");

        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        updateDifficultyInfo(difficulty);
      }

      function updateDifficultyInfo(difficulty) {
        const info = document.getElementById("difficultyInfo");
        const difficultyData = {
          easy: {
            title: "–õ–µ–≥–∫–∏–π —É—Ä–æ–≤–µ–Ω—å",
            features: [
              "‚Ä¢ –ú–µ–¥–ª–µ–Ω–Ω–∞—è –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è",
              "‚Ä¢ –®–∏—Ä–æ–∫–∏–µ –ø—Ä–æ—Ö–æ–¥—ã –º–µ–∂–¥—É —Ç—Ä—É–±–∞–º–∏",
              "‚Ä¢ –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ç—Ä—É–±",
              "‚Ä¢ –†–µ–¥–∫–∏–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è",
              "‚Ä¢ –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –æ—Å–Ω–æ–≤!",
            ],
          },
          medium: {
            title: "–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å",
            features: [
              "‚Ä¢ –û–±—ã—á–Ω–∞—è –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è",
              "‚Ä¢ –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ—Ö–æ–¥—ã –º–µ–∂–¥—É —Ç—Ä—É–±–∞–º–∏",
              "‚Ä¢ –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ç—Ä—É–±",
              "‚Ä¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π",
              "‚Ä¢ –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å",
            ],
          },
          hard: {
            title: "–°–ª–æ–∂–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å",
            features: [
              "‚Ä¢ –í—ã—Å–æ–∫–∞—è –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è",
              "‚Ä¢ –£–∑–∫–∏–µ –ø—Ä–æ—Ö–æ–¥—ã –º–µ–∂–¥—É —Ç—Ä—É–±–∞–º–∏",
              "‚Ä¢ –ë—ã—Å—Ç—Ä–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ç—Ä—É–±",
              "‚Ä¢ –ß–∞—Å—Ç—ã–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è",
              "‚Ä¢ –î–ª—è –æ–ø—ã—Ç–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤!",
            ],
          },
        };

        const data = difficultyData[difficulty];
        info.innerHTML = `<strong>${
          data.title
        }:</strong><br>${data.features.join("<br>")}`;
      }

      // ===========================================
      // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
      // ===========================================

      function updateScore() {
        document.getElementById(
          "score"
        ).textContent = `–°—á—ë—Ç: ${score} (${getDifficultyEmoji()} ${currentDifficulty.toUpperCase()})`;
      }

      function getDifficultyEmoji() {
        const emojis = { easy: "üòä", medium: "üòê", hard: "üò§" };
        return emojis[currentDifficulty] || "üòä";
      }

      // –ü—Ä–æ—Å—Ç–æ–π –∑–≤—É–∫–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç
      function playSound() {
        // –°–æ–∑–¥–∞–Ω–∏–µ –∑–≤—É–∫–∞ —á–µ—Ä–µ–∑ Web Audio API
        try {
          const audioContext = new (window.AudioContext ||
            window.webkitAudioContext)();
          const oscillator = audioContext.createOscillator();
          const gainNode = audioContext.createGain();

          oscillator.connect(gainNode);
          gainNode.connect(audioContext.destination);

          oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
          gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(
            0.01,
            audioContext.currentTime + 0.1
          );

          oscillator.start(audioContext.currentTime);
          oscillator.stop(audioContext.currentTime + 0.1);
        } catch (e) {
          // –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Web Audio API
          console.log("–ó–≤—É–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω");
        }
      }

      // ===========================================
      // –ó–ê–ü–£–°–ö –ò–ì–†–´
      // ===========================================

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª—É—á—à–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
      document.getElementById(
        "bestScore"
      ).textContent = `–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${bestScore}`;

      // –ó–∞–ø—É—Å–∫ –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞
      gameLoop();

      // ===========================================
      // –û–ë–£–ß–ê–Æ–©–ò–ï –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ò
      // ===========================================

      /*
        –û–ë–†–ê–ó–û–í–ê–¢–ï–õ–¨–ù–´–ï –ö–û–ù–¶–ï–ü–¶–ò–ò –í –≠–¢–û–ô –ò–ì–†–ï:
        
        1. CANVAS API - –†–∏—Å–æ–≤–∞–Ω–∏–µ 2D –≥—Ä–∞—Ñ–∏–∫–∏
        2. –ò–ì–†–û–í–û–ô –¶–ò–ö–õ - –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∞
        3. –§–ò–ó–ò–ö–ê - –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è, —Å–∫–æ—Ä–æ—Å—Ç—å, —É—Å–∫–æ—Ä–µ–Ω–∏–µ
        4. –û–ë–ù–ê–†–£–ñ–ï–ù–ò–ï –°–¢–û–õ–ö–ù–û–í–ï–ù–ò–ô - –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π
        5. –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–û–°–¢–û–Ø–ù–ò–Ø–ú–ò - –†–∞–∑–Ω—ã–µ —Ä–µ–∂–∏–º—ã –∏–≥—Ä—ã
        6. –ê–ù–ò–ú–ê–¶–ò–Ø - –ü–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
        7. LOCAL STORAGE - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –±—Ä–∞—É–∑–µ—Ä–µ
        8. –û–ë–†–ê–ë–û–¢–ö–ê –°–û–ë–´–¢–ò–ô - –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∏ –º—ã—à—å
        9. WEB AUDIO API - –°–æ–∑–¥–∞–Ω–∏–µ –∑–≤—É–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ
        10. –†–ï–°–ü–û–ù–°–ò–í–ù–´–ô –î–ò–ó–ê–ô–ù - –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã
        
        –ê–õ–ì–û–†–ò–¢–ú–´:
        - –ü—Ä–æ—Ü–µ–¥—É—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
        - –°–∏—Å—Ç–µ–º–∞ —Å—á—ë—Ç–∞
        - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é (—É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤)
        */
    </script>
  </body>
</html>
